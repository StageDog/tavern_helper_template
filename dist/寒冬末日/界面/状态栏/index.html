<!doctype html><html><head><style>.imprint-section .progress-bar-value[data-v-054f603c]{background:linear-gradient(90deg,#7aa2f7,#f1fa8c)}.imprint-status-subtext[data-v-054f603c]{margin-top:4px;color:var(--accent-blue,#8be9fd);font-size:0.9em}.imprint-hint[data-v-054f603c]{color:var(--text-color);opacity:0.7}.imprint-change[data-v-054f603c]{color:var(--accent-gold,#f1fa8c)}.imprint-bar[data-v-054f603c]{margin-top:6px}

.status-pill[data-v-054f603c]{margin-left:8px;padding:2px 6px;border-radius:6px;font-size:0.75em;border:1px solid var(--border-color,rgba(255,255,255,0.2));background:rgba(255,255,255,0.05)}.status-pill.登场[data-v-054f603c]{color:#50fa7b;border-color:#50fa7b55;background:#50fa7b11}.status-pill.离场[data-v-054f603c]{color:#f1fa8c;border-color:#f1fa8c55;background:#f1fa8c11}

.mission-content[data-v-15f30780]{display:flex;flex-direction:column;gap:12px}.mission-phase[data-v-15f30780]{background-color:var(--bg-medium);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.05)}.phase-label[data-v-15f30780]{font-size:0.85em;color:var(--text-color);opacity:0.8;margin-bottom:6px}.phase-name[data-v-15f30780]{font-size:1em;font-weight:bold;color:var(--accent-gold)}.goals-progress-bar[data-v-15f30780]{background-color:var(--bg-medium);padding:12px;border-radius:8px;border:1px solid rgba(255,255,255,0.05)}.progress-header[data-v-15f30780]{display:flex;justify-content:space-between;margin-bottom:8px;font-size:0.9em;color:var(--text-color)}.progress-text[data-v-15f30780]{color:var(--accent-gold);font-weight:bold}.progress-track[data-v-15f30780]{height:8px;background-color:var(--bg-dark);border-radius:4px;overflow:hidden}.progress-fill[data-v-15f30780]{height:100%;background:linear-gradient(90deg,var(--dialog-color),var(--accent-gold));border-radius:4px;transition:width 0.3s ease}.mission-goals[data-v-15f30780],.mission-intel[data-v-15f30780]{margin-top:4px}.goals-count[data-v-15f30780],.intel-count[data-v-15f30780]{font-size:0.85em;opacity:0.7}.intel-empty-hint[data-v-15f30780]{margin-top:6px;font-size:0.8em;color:var(--text-color);opacity:0.7}.goals-list[data-v-15f30780],.intel-list[data-v-15f30780]{margin-top:8px;padding:8px;background-color:var(--bg-dark);border-radius:8px}.goal-item[data-v-15f30780]{display:flex;align-items:flex-start;gap:10px;padding:10px 8px;border-bottom:1px solid rgba(255,255,255,0.05);transition:all 0.2s ease}.goal-item[data-v-15f30780]:last-child{border-bottom:none}.goal-item.empty[data-v-15f30780]{color:var(--text-color);opacity:0.6;justify-content:center}.goal-item.completed[data-v-15f30780]{background-color:rgba(80,250,123,0.1)}.goal-checkbox[data-v-15f30780]{width:22px;height:22px;flex-shrink:0;margin-top:1px}.check-icon[data-v-15f30780]{width:100%;height:100%;fill:var(--dialog-color)}.check-icon.empty[data-v-15f30780]{fill:var(--bg-light);stroke:var(--text-color);opacity:0.5}.goal-content[data-v-15f30780]{flex:1;display:flex;flex-direction:column;gap:4px}.goal-text[data-v-15f30780]{font-size:0.9em;color:var(--text-color);line-height:1.4;transition:all 0.2s ease}.goal-meta[data-v-15f30780]{display:flex;gap:6px;flex-wrap:wrap}.meta-chip[data-v-15f30780]{font-size:0.75em;padding:2px 6px;border-radius:6px;background:rgba(255,255,255,0.08);color:var(--accent-blue);border:1px solid rgba(255,255,255,0.08)}.goal-text.completed[data-v-15f30780]{opacity:0.6;text-decoration:line-through}.goal-status-tag[data-v-15f30780]{font-size:0.7em;padding:2px 6px;border-radius:4px;background-color:var(--dialog-color);color:var(--bg-dark);font-weight:bold}.intel-item[data-v-15f30780]{display:flex;align-items:flex-start;gap:12px;background-color:var(--bg-medium);padding:12px;border-radius:8px;margin-bottom:8px;border-left:3px solid transparent;transition:all 0.2s ease}.intel-item[data-v-15f30780]:last-child{margin-bottom:0}.intel-item.empty[data-v-15f30780]{text-align:center;color:var(--text-color);opacity:0.6;padding:16px;justify-content:center;border-left:none}.intel-item.已完成[data-v-15f30780]{border-left-color:var(--dialog-color);background-color:rgba(80,250,123,0.08)}.intel-item.已探索[data-v-15f30780]{border-left-color:var(--accent-blue);background-color:rgba(189,147,249,0.08)}.intel-item.未探索[data-v-15f30780]{border-left-color:var(--text-color);opacity:0.7}.intel-status-ring[data-v-15f30780]{width:36px;height:36px;flex-shrink:0;position:relative}.progress-ring[data-v-15f30780]{width:100%;height:100%;transform:rotate(-90deg)}.ring-bg[data-v-15f30780]{fill:none;stroke:var(--bg-dark);stroke-width:2}.ring-progress[data-v-15f30780]{fill:none;stroke-width:2;stroke-linecap:round;transition:stroke-dasharray 0.3s ease}.ring-progress.已完成[data-v-15f30780]{stroke:var(--dialog-color)}.ring-progress.已探索[data-v-15f30780]{stroke:var(--accent-blue)}.ring-progress.未探索[data-v-15f30780]{stroke:var(--text-color);opacity:0.5}.ring-icon[data-v-15f30780]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:0.75em;font-weight:bold}.intel-content[data-v-15f30780]{flex:1;min-width:0}.intel-header[data-v-15f30780]{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}.intel-id[data-v-15f30780]{font-weight:bold;color:var(--accent-gold);font-size:0.9em}.intel-status-badge[data-v-15f30780]{font-size:0.7em;padding:2px 8px;border-radius:4px;font-weight:bold}.intel-status-badge.未探索[data-v-15f30780]{color:var(--text-color);background-color:var(--bg-dark)}.intel-status-badge.已探索[data-v-15f30780]{color:var(--bg-dark);background-color:var(--accent-blue)}.intel-status-badge.已完成[data-v-15f30780]{color:var(--bg-dark);background-color:var(--dialog-color)}.intel-desc[data-v-15f30780]{font-size:0.85em;color:var(--text-color);margin-bottom:8px;line-height:1.4}.intel-meta[data-v-15f30780]{display:flex;gap:12px;font-size:0.75em}.intel-value[data-v-15f30780]{color:var(--accent-gold)}.intel-risk[data-v-15f30780]{color:var(--accent-red)}

.markdown-table[data-v-f10a00a4]{width:100%;border-collapse:collapse;margin:12px 0;font-size:0.9em;background-color:var(--bg-medium);border-radius:8px;overflow:hidden}.markdown-table th[data-v-f10a00a4],.markdown-table td[data-v-f10a00a4]{padding:10px 12px;text-align:left;border-bottom:1px solid rgba(255,255,255,0.1)}.markdown-table th[data-v-f10a00a4]{background-color:var(--bg-dark);color:var(--accent-gold);font-weight:bold;font-size:0.85em}.markdown-table td[data-v-f10a00a4]{color:var(--text-color);line-height:1.5}.markdown-table td[data-v-f10a00a4] strong{color:var(--text-strong)}.markdown-table td[data-v-f10a00a4] em{color:var(--accent-blue)}.markdown-table td[data-v-f10a00a4] .inline-bracket{color:var(--accent-blue);font-weight:600}.markdown-table tr:last-child td[data-v-f10a00a4]{border-bottom:none}.markdown-table tbody tr[data-v-f10a00a4]:hover{background-color:rgba(255,255,255,0.03)}.system-message[data-v-f10a00a4]{background-color:rgba(0,180,216,0.1);border:1px solid rgba(0,180,216,0.4);border-radius:8px;padding:12px 16px;margin:12px 0;font-family:'Consolas','Monaco','Courier New',monospace;font-size:0.9em;line-height:1.6;color:var(--accent-cyan,#00b4d8);overflow-x:auto}.system-message pre[data-v-f10a00a4]{margin:0;white-space:pre-wrap;word-wrap:break-word}.system-hint[data-v-f10a00a4]{color:var(--accent-gold,#f1fa8c);font-weight:500}.character-name[data-v-f10a00a4]{color:var(--accent-blue,#bd93f9);font-weight:600}.image-prompt[data-v-f10a00a4]{display:block;background-color:rgba(255,255,255,0.05);border:1px dashed rgba(255,255,255,0.2);border-radius:4px;padding:8px 12px;margin:8px 0;font-family:'Consolas','Monaco','Courier New',monospace;font-size:0.85em;color:var(--accent-gold);overflow-x:auto}.inline-bracket[data-v-f10a00a4]{color:var(--accent-blue,#bd93f9);font-weight:600}

:root{--bg-main:#1a1b26;--bg-light:#282a36;--bg-medium:#44475a;--bg-dark:#13141b;--border-color:#8be9fd;--border-shadow-color:#b3f2ff;--text-color:#f8f8f2;--text-strong:#ffffff;--dialog-color:#50fa7b;--thought-color:#ff79c6;--accent-gold:#f1fa8c;--accent-red:#ff5555;--accent-blue:#bd93f9;--accent-cyan:#00b4d8;--health-bar-color:#50fa7b;--border-radius:12px;--section-gap:16px;--inner-padding:18px;--transition-speed:0.3s;--font-main:'Microsoft YaHei',-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif}:root[data-theme='jade_green']{--bg-main:#f0f8f8;--bg-light:#ffffff;--bg-medium:#e0f0e0;--bg-dark:#d0e0d0;--border-color:#20b2aa;--border-shadow-color:#a7dbd8;--text-color:#333333;--text-strong:#000000;--dialog-color:#1e90ff;--thought-color:#6a5acd;--accent-gold:#ffa500;--accent-red:#dc143c;--accent-blue:#4682b4;--accent-cyan:#00b4d8;--health-bar-color:#28a745}:root[data-theme='parchment']{--bg-main:#efe3c3;--bg-light:#e8d9b0;--bg-medium:#c3a56e;--bg-dark:#6c4a24;--border-color:#8a6642;--border-shadow-color:#5a3a28;--text-color:#3a2d1f;--text-strong:#000000;--dialog-color:#1e3a8a;--thought-color:#8b0000;--accent-gold:#c19a49;--accent-red:#8b3a3a;--accent-blue:#2c4875;--accent-cyan:#008b8b;--health-bar-color:#d2691e}:root[data-theme='milky']{--bg-main:#f5f5f5;--bg-medium:#e8e8e8;--bg-light:#ffffff;--bg-dark:#dcdcdc;--border-color:#79a07b;--border-shadow-color:#c0c0c0;--text-color:#4a4a4a;--text-strong:#000000;--dialog-color:#4682b4;--thought-color:#6a5acd;--accent-gold:#d2b48c;--accent-red:#cd5c5c;--accent-blue:#5f9ea0;--accent-cyan:#20b2aa;--health-bar-color:#8fbc8f}*{box-sizing:border-box}body{font-family:var(--font-main);margin:0;padding:8px;background-color:transparent;color:var(--text-color);line-height:1.7}main{font-size:var(--font-size-main,16px);border:1px solid var(--border-color);box-shadow:0 0 25px 0px var(--border-shadow-color),inset 0 0 15px rgba(255,255,255,0.05);background-color:var(--bg-main);padding:20px;border-radius:var(--border-radius);max-width:900px;margin:10px auto;width:100%;display:flex;flex-direction:column;gap:var(--section-gap)}.section{background-color:var(--bg-light);padding:var(--inner-padding);border-radius:var(--border-radius);border:1px solid rgba(200,200,220,0.1);position:relative}.section-title{font-size:1.25em;font-weight:bold;color:var(--text-strong);text-align:center;margin:0 0 16px 0;border-bottom:2px solid var(--border-color);padding-bottom:10px}.choices-title{text-align:left;border-bottom:none;padding-bottom:0}.global-info-bar{display:flex;flex-direction:column;align-items:flex-start;gap:8px}.info-item{padding:4px 10px;border-radius:8px;background-color:var(--bg-medium);font-size:0.9em;width:100%;white-space:normal}.info-item--location{color:var(--accent-blue)}.info-item--date{color:var(--accent-gold)}.info-item--time{color:var(--accent-red)}.content-text{white-space:pre-line;word-break:break-word}.dialog-text{color:var(--dialog-color);font-weight:500}.thought-text{color:var(--thought-color);font-style:italic}.system-text{color:var(--accent-gold);font-weight:bold;text-shadow:0 0 5px rgba(241,250,140,0.3);display:inline-block;margin:4px 0}.eden-text{color:#00ffff;font-family:'Courier New',monospace;background:rgba(0,255,255,0.1);padding:2px 6px;border-radius:4px;border-left:2px solid #00ffff;display:block;margin:6px 0}.story-image{max-width:100%;height:auto;border-radius:8px;margin:10px 0;display:block;box-shadow:0 4px 6px rgba(0,0,0,0.3)}.shelter-grid{display:grid;grid-template-columns:1fr;gap:12px}.shelter-item .label{font-size:0.9em;color:var(--text-color);opacity:0.8;margin-bottom:6px}.shelter-item .value{font-size:1.05em;color:var(--text-strong);white-space:pre-line;word-break:break-word}.ability-list{max-height:280px;overflow-y:auto;padding:10px;background-color:var(--bg-dark);border-radius:8px}.ability-card{background-color:var(--bg-medium);padding:12px;border-radius:6px;margin-bottom:8px}.ability-card .name{font-weight:bold;color:var(--border-color);margin-bottom:4px}.ability-card .desc{font-size:0.85em;opacity:0.9;line-height:1.4;white-space:pre-line}.status-tabs-container{background-color:var(--bg-main);border-radius:var(--border-radius);padding:10px}.tab-buttons{display:flex;flex-wrap:nowrap;gap:8px;margin-bottom:10px;overflow-x:auto;padding-bottom:8px}.tab-button{background-color:var(--bg-medium);color:var(--text-color);padding:8px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.1);cursor:pointer;font-size:0.9em;white-space:nowrap;transition:all var(--transition-speed)}.tab-button:hover{background-color:var(--border-color);color:var(--bg-dark)}.tab-button.active{background-color:var(--border-color);color:var(--bg-dark);font-weight:bold;box-shadow:0 0 10px rgba(139,233,253,0.4)}.tab-content{display:none;animation:fadeEffect var(--transition-speed)}.tab-content.active{display:block}@keyframes fadeEffect{from{opacity:0}to{opacity:1}}.status-grid{display:flex;flex-direction:column;gap:14px}.status-item{background-color:var(--bg-light);padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.05)}.status-item .label{font-weight:bold;color:var(--accent-blue);margin-bottom:6px;font-size:0.95em}.status-item .value{color:var(--text-strong);white-space:pre-line;word-break:break-word}.health-section-header{display:flex;align-items:baseline;justify-content:space-between;gap:10px}.health-status-subtext{font-size:0.85em;opacity:0.85;margin:4px 0 10px 0;color:var(--accent-gold)}.value-subtext{font-size:0.85em;opacity:0.9;margin-top:8px;color:var(--accent-red);white-space:pre-line}.progress-bar-container{width:100%;height:12px;background-color:var(--bg-dark);border-radius:6px;overflow:hidden;border:1px solid rgba(255,255,255,0.1)}.progress-bar-value{height:100%;width:0%;background-color:var(--health-bar-color);border-radius:6px;transition:width var(--transition-speed)}.details-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}.other-residents-item{padding:10px;border-radius:8px;background-color:var(--bg-medium);margin-bottom:10px}.other-residents-item .label{font-weight:bold;color:var(--accent-blue);margin-bottom:4px}.other-residents-item .value{white-space:pre-line;word-break:break-word}.choice-item{width:100%;text-align:left;background-color:var(--bg-medium);padding:10px;border-radius:8px;margin-bottom:8px;cursor:pointer;transition:all var(--transition-speed);border:0;color:inherit;font:inherit}.choice-item:hover{background-color:var(--border-color);color:var(--bg-dark)}.palette-button{position:absolute;top:16px;right:16px;width:38px;height:38px;border-radius:50%;border:1px solid var(--border-color);background:var(--bg-medium);color:var(--text-color);cursor:pointer;font-size:18px;display:flex;align-items:center;justify-content:center;transition:all var(--transition-speed)}.palette-button:hover{background:var(--border-color);color:var(--bg-dark)}.palette-modal{position:absolute;top:60px;right:16px;width:260px;background:var(--bg-light);border:1px solid var(--border-color);border-radius:10px;box-shadow:0 0 20px rgba(0,0,0,0.4);padding:14px;display:none;z-index:50}.palette-modal.show{display:block}.palette-modal h3{margin:0 0 10px 0;font-size:1em;color:var(--text-strong)}.palette-option{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.palette-option label{font-size:0.85em;color:var(--text-color)}.palette-option select{width:120px;padding:4px;border-radius:6px;border:1px solid rgba(255,255,255,0.15);background:var(--bg-medium);color:var(--text-color)}.palette-buttons{display:flex;justify-content:flex-end}.palette-buttons button{padding:6px 10px;border-radius:8px;border:none;background:var(--border-color);color:var(--bg-dark);cursor:pointer;font-weight:bold}.palette-buttons button:hover{background:var(--border-shadow-color)}.ability-list::-webkit-scrollbar{width:8px}.ability-list::-webkit-scrollbar-track{background:var(--bg-dark);border-radius:4px}.ability-list::-webkit-scrollbar-thumb{background-color:var(--border-color);border-radius:4px;border:2px solid var(--bg-dark)}.ability-list::-webkit-scrollbar-thumb:hover{background-color:var(--border-shadow-color)}.expansion-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:8px;margin-top:8px}.expansion-card{background-color:var(--bg-dark);padding:10px;border-radius:8px;text-align:center;border:1px solid rgba(255,255,255,0.05);opacity:0.5;transition:all var(--transition-speed)}.expansion-card.unlocked{opacity:1;border-color:var(--border-color);box-shadow:0 0 10px rgba(139,233,253,0.1);background-color:var(--bg-medium)}.expansion-card .name{font-size:0.9em;font-weight:bold;color:var(--text-color);margin-bottom:4px}.expansion-card.unlocked .name{color:var(--accent-gold)}.expansion-card .status{font-size:0.8em;color:var(--accent-red)}.expansion-card.unlocked .status{color:var(--dialog-color)}@media (max-width:600px){.details-grid{grid-template-columns:1fr}main{padding:12px;margin:5px auto;font-size:var(--font-size-main,14px)}.tab-button{padding:6px 10px;font-size:0.85em}}.map-toggle-btn,.collapse-toggle-btn{display:flex;align-items:center;gap:8px;width:100%;padding:10px 14px;background-color:var(--bg-medium);border:1px solid var(--border-color);border-radius:8px;color:var(--text-color);cursor:pointer;font-size:0.95em;transition:all var(--transition-speed);margin-bottom:8px}.map-toggle-btn:hover,.collapse-toggle-btn:hover{background-color:var(--border-color);color:var(--bg-dark)}.toggle-icon{font-size:0.8em;transition:transform var(--transition-speed)}.toggle-text{flex:1;text-align:left}.map-container{animation:slideDown var(--transition-speed)}@keyframes slideDown{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.map-zone{margin-bottom:16px;padding:12px;background-color:var(--bg-dark);border-radius:10px;border:1px solid rgba(255,255,255,0.05)}.zone-label{font-weight:bold;color:var(--accent-gold);margin-bottom:10px;font-size:0.95em;display:flex;align-items:center;gap:6px}.floor-indicator{text-align:center;font-size:0.8em;color:var(--text-color);opacity:0.6;margin:8px 0;padding:4px;border-top:1px dashed rgba(255,255,255,0.1);border-bottom:1px dashed rgba(255,255,255,0.1)}.room-grid{display:grid;gap:6px}.entrance-grid{grid-template-columns:repeat(3,1fr)}.core-grid{grid-template-columns:repeat(2,1fr)}.floor-grid{grid-template-columns:repeat(6,1fr)}.expansion-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}.room-cell{background-color:var(--bg-medium);padding:8px 6px;border-radius:6px;text-align:center;border:1px solid rgba(255,255,255,0.05);transition:all var(--transition-speed);min-height:56px;display:flex;flex-direction:column;justify-content:center}.room-cell:hover{border-color:var(--border-color);box-shadow:0 0 8px rgba(139,233,253,0.2)}.room-cell.highlight{background-color:var(--bg-light);border-color:var(--border-color);box-shadow:0 0 10px rgba(139,233,253,0.15)}.room-cell.user-room{border-color:var(--accent-gold);background-color:rgba(241,250,140,0.1)}.room-cell.user-room .room-number{color:var(--accent-gold)}.room-cell.occupied{border-color:var(--dialog-color);background-color:rgba(80,250,123,0.08)}.room-cell.occupied .room-value{color:var(--dialog-color)}.room-number{font-size:0.8em;font-weight:bold;color:var(--text-strong);margin-bottom:4px}.room-value{font-size:0.75em;color:var(--accent-blue);margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.room-resident{font-size:0.7em;color:var(--text-color);opacity:0.8;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.expansion-cell{background-color:var(--bg-medium);padding:10px 8px;border-radius:8px;text-align:center;border:1px dashed rgba(255,255,255,0.1);opacity:0.5;transition:all var(--transition-speed)}.expansion-cell.unlocked{opacity:1;border-style:solid;border-color:var(--border-color);background-color:var(--bg-light)}.expansion-icon{font-size:1.4em;margin-bottom:4px}.expansion-name{font-size:0.85em;font-weight:bold;color:var(--text-color);margin-bottom:4px}.expansion-status{font-size:0.7em;color:var(--accent-red)}.expansion-cell.unlocked .expansion-status{color:var(--dialog-color)}@media (max-width:600px){.entrance-grid{grid-template-columns:repeat(3,1fr)}.core-grid{grid-template-columns:repeat(2,1fr)}.floor-grid{grid-template-columns:repeat(4,1fr)}.expansion-grid{grid-template-columns:repeat(3,1fr)}.room-cell{min-height:48px;padding:6px 4px}.room-number{font-size:0.75em}.room-resident{font-size:0.65em}}@media (max-width:400px){.floor-grid{grid-template-columns:repeat(3,1fr)}.expansion-grid{grid-template-columns:repeat(2,1fr)}}


/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div><script>/*! For license information please see index.js.LICENSE.txt */
(()=>{'use strict';var e={455(e,t){t.A=(e,t)=>{const r=e.__vccOpts||e;for(const[e,n]of t)r[e]=n;return r}}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const n=Vue,a=_;var s=r.n(a);const l=z,i=l.z.object({世界:l.z.object({地址:l.z.string().prefault('').describe('当前所在的物理位置'),日期:l.z.string().prefault('').describe('格式：末日纪元，XXXX年XX月XX日'),时间:l.z.string().prefault('').describe('格式：时间段 - HH:MM'),末日天数:l.z.coerce.number().prefault(0).describe('自"永恒暴雪"降临以来的总天数')}).prefault({地址:'',日期:'',时间:'',末日天数:0}),庇护所:l.z.object({庇护所等级:l.z.coerce.number().transform(e=>_.clamp(e,1,10)).prefault(1).describe('等级上限为10。升级来源：1.每日Roll点命中；2.剧情奖励；3.保底触发(7天)。'),今日投掷点数:l.z.string().prefault('').describe('记录每日升级判定结果。跨天时Roll点(0-10)，命中幸运数(7,10)触发升级。格式："今日已投掷: X点 (触发幸运升级！/未升级)"'),距离上次升级:l.z.string().prefault('').describe('记录保底进度。若连续7天未升级，则在第8天跨天时强制触发保底升级。格式："X天 | 剩余保底升级天数：Y天"。升级后重置。'),庇护所能力:l.z.record(l.z.string().describe('能力名'),l.z.object({desc:l.z.string()}).prefault({desc:''})).prefault({}).describe('已激活的庇护所能力列表。包含等级提升奖励与主线任务解锁的特殊奖励。'),可扩展区域:l.z.object({医疗翼:l.z.string().prefault('未解锁').describe('等级3:初级医疗舱; 等级6:外科手术台; 等级9:专家级自动医师'),制造工坊:l.z.string().prefault('未解锁').describe('任务奖励解锁: "非致命防御制造器"(阶段一), "轻型军火熔炉"(阶段二); 等级5解锁"伊甸荚舱"; 等级8解锁"重型军械库"'),载具格纳库:l.z.string().prefault('未解锁').describe('等级7解锁"先驱者制造单元"; 阶段三任务解锁"工业原料合成器"')}).prefault({医疗翼:'未解锁',制造工坊:'未解锁',载具格纳库:'未解锁'}).describe('记录庇护所可扩展区域的解锁状态')}).prefault({庇护所等级:1,今日投掷点数:'',距离上次升级:'',庇护所能力:{},可扩展区域:{医疗翼:'未解锁',制造工坊:'未解锁',载具格纳库:'未解锁'}}),房间:l.z.object({玄关:l.z.object({临时客房A入住者:l.z.array(l.z.string()).prefault([]).describe('临时客房A入住者姓名列表'),临时客房B入住者:l.z.array(l.z.string()).prefault([]).describe('临时客房B入住者姓名列表')}).prefault({临时客房A入住者:[],临时客房B入住者:[]}).describe('玄关区域房间状态'),核心区:l.z.object({主卧室使用者:l.z.array(l.z.string()).prefault([]).describe('主卧室使用者姓名列表'),主浴室使用者:l.z.array(l.z.string()).prefault([]).describe('主浴室使用者姓名列表')}).prefault({主卧室使用者:[],主浴室使用者:[]}).describe('核心区域房间状态'),楼层房间:l.z.object({楼层20房间:l.z.record(l.z.string(),l.z.object({入住者:l.z.array(l.z.string())}).prefault({入住者:[]})).prefault({}).describe('20层各房间状态，key为房间号'),楼层19房间:l.z.record(l.z.string(),l.z.object({入住者:l.z.array(l.z.string())}).prefault({入住者:[]})).prefault({}).describe('19层各房间状态，key为房间号')}).prefault({楼层20房间:{},楼层19房间:{}}).describe('楼层房间状态')}).prefault({玄关:{临时客房A入住者:[],临时客房B入住者:[]},核心区:{主卧室使用者:[],主浴室使用者:[]},楼层房间:{楼层20房间:{},楼层19房间:{}}}),主线任务:l.z.object({当前阶段:l.z.string().prefault('阶段一：秩序的萌芽').describe('主线任务的当前阶段名称'),阶段目标:l.z.record(l.z.string(),l.z.object({描述:l.z.string(),当前值:l.z.coerce.number().prefault(0),目标值:l.z.coerce.number().prefault(1)})).prefault({'肃清20、19、21层的敌对幸存者':{描述:'肃清20、19、21层的敌对幸存者',当前值:0,目标值:3},庇护至少3个核心女性角色或家庭:{描述:'庇护至少3个核心女性角色或家庭',当前值:0,目标值:3},完成一个公寓内部的情报碎片任务:{描述:'完成一个公寓内部的情报碎片任务',当前值:0,目标值:1}}).describe('当前阶段需要达成的目标列表'),目标完成状态:l.z.record(l.z.string(),l.z.boolean()).prefault({0:!1,1:!1,2:!1}).describe('目标完成状态，key为索引字符串（0/1/2...），value为true表示完成'),情报碎片:l.z.record(l.z.string(),l.z.object({编号:l.z.string().prefault(''),描述:l.z.string().prefault(''),价值:l.z.string().prefault(''),风险:l.z.string().prefault(''),状态:l.z.enum(['未探索','已探索','已完成']).prefault('未探索')}).prefault({编号:'',描述:'',价值:'',风险:'',状态:'未探索'})).prefault({}).describe('已解锁的情报碎片')}).prefault({当前阶段:'阶段一：秩序的萌芽',阶段目标:{'肃清20、19、21层的敌对幸存者':{描述:'肃清20、19、21层的敌对幸存者',当前值:0,目标值:3},庇护至少3个核心女性角色或家庭:{描述:'庇护至少3个核心女性角色或家庭',当前值:0,目标值:3},完成一个公寓内部的情报碎片任务:{描述:'完成一个公寓内部的情报碎片任务',当前值:0,目标值:1}},目标完成状态:{0:!1,1:!1,2:!1},情报碎片:{}}),浅见亚美:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因。格式："+/-X, 原因"。无变化则为"0, 无变化"。'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因。格式："+/-X, 原因"。无变化则为"0, 无变化"。'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),相田哲也:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),星野琉璃:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),早川遥:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),早川舞:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),藤井雪乃:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),中村惠子:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),爱宫心爱:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),爱宫铃:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),'桃乐丝・泽巴哈':l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),何铃:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),王静:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),康绮月:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),薛萍:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),小泽花:l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'}),临时NPC:l.z.record(l.z.string(),l.z.object({姓名:l.z.string().prefault(''),关系:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色当前对{{user}}的关系档位'),关系倾向:l.z.enum(['拒绝','交易','顺从','忠诚','性奴']).prefault('拒绝').describe('角色关系的倾向（可理解为更偏向于哪一档）'),秩序刻印:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(20).describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),秩序刻印更新原因:l.z.string().prefault('').describe('记录秩序刻印变化的原因。格式："+/-X, 原因"。无变化则为"0, 无变化"。'),健康:l.z.coerce.number().transform(e=>_.clamp(e,0,100)).prefault(100).describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),健康更新原因:l.z.string().prefault('').describe('记录健康值变化的原因。格式："+/-X, 原因"。无变化则为"0, 无变化"。'),健康状况:l.z.enum(['健康','亚健康','生病/受伤','重病/濒死','无','死亡']).prefault('健康').describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),衣着:l.z.string().prefault('').describe('详细描述当前的衣着状态'),舌唇:l.z.string().prefault('').describe('口腔、嘴唇的状态'),胸乳:l.z.string().prefault('').describe('胸部的状态'),私穴:l.z.string().prefault('').describe('私处的详细状态'),神态样貌:l.z.string().prefault('').describe('面部表情和神态'),动作姿势:l.z.string().prefault('').describe('身体姿态和动作'),内心想法:l.z.string().prefault('').describe('第一人称内心独白'),登场状态:l.z.enum(['登场','离场']).prefault('离场').describe('值为"登场"时显示在UI。角色不出现时设为"离场"')}).prefault({姓名:'',关系:'拒绝',关系倾向:'拒绝',秩序刻印:20,健康:100,健康更新原因:'',健康状况:'健康',衣着:'',舌唇:'',胸乳:'',私穴:'',神态样貌:'',动作姿势:'',内心想法:'',秩序刻印更新原因:'',登场状态:'离场'})).prefault({}).describe('存储所有临时NPC的状态，key为NPC姓名。新NPC登场时在此处添加。'),楼层其他住户:l.z.object({言语:l.z.string().prefault('').describe('其他幸存者的总体言语状态'),行为:l.z.string().prefault('').describe('其他幸存者的总体行为状态')}).prefault({言语:'',行为:''})}),o='undefined'!=typeof window;let c;const u=e=>c=e,d=Symbol();function p(e){return e&&'object'==typeof e&&'[object Object]'===Object.prototype.toString.call(e)&&'function'!=typeof e.toJSON}var m;!function(e){e.direct='direct',e.patchObject='patch object',e.patchFunction='patch function'}(m||(m={}));const f=(()=>'object'==typeof window&&window.window===window?window:'object'==typeof self&&self.self===self?self:'object'==typeof globalThis&&globalThis.global===globalThis||'object'==typeof globalThis?globalThis:{HTMLElement:null})();function g(e,t,r){const n=new XMLHttpRequest;n.open('GET',e),n.responseType='blob',n.onload=function(){E(n.response,t,r)},n.onerror=function(){console.error('could not download file')},n.send()}function b(e){const t=new XMLHttpRequest;t.open('HEAD',e,!1);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function v(e){try{e.dispatchEvent(new MouseEvent('click'))}catch(t){const r=new MouseEvent('click',{bubbles:!0,cancelable:!0,view:window,detail:0,screenX:80,screenY:20,clientX:80,clientY:20,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null});e.dispatchEvent(r)}}const h='object'==typeof navigator?navigator:{userAgent:''},y=(()=>/Macintosh/.test(h.userAgent)&&/AppleWebKit/.test(h.userAgent)&&!/Safari/.test(h.userAgent))(),E=o?'undefined'!=typeof HTMLAnchorElement&&'download'in HTMLAnchorElement.prototype&&!y?function(e,t='download',r){const n=document.createElement('a');n.download=t,n.rel='noopener','string'==typeof e?(n.href=e,n.origin!==location.origin?b(n.href)?g(e,t,r):(n.target='_blank',v(n)):v(n)):(n.href=URL.createObjectURL(e),setTimeout(function(){URL.revokeObjectURL(n.href)},4e4),setTimeout(function(){v(n)},0))}:'msSaveOrOpenBlob'in h?function(e,t='download',r){if('string'==typeof e)if(b(e))g(e,t,r);else{const t=document.createElement('a');t.href=e,t.target='_blank',setTimeout(function(){v(t)})}else navigator.msSaveOrOpenBlob(function(e,{autoBom:t=!1}={}){return t&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,r),t)}:function(e,t,r,n){(n=n||open('','_blank'))&&(n.document.title=n.document.body.innerText='downloading...');if('string'==typeof e)return g(e,t,r);const a='application/octet-stream'===e.type,s=/constructor/i.test(String(f.HTMLElement))||'safari'in f,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&s||y)&&'undefined'!=typeof FileReader){const t=new FileReader;t.onloadend=function(){let e=t.result;if('string'!=typeof e)throw n=null,new Error('Wrong reader.result type');e=l?e:e.replace(/^data:[^;]*;/,'data:attachment/file;'),n?n.location.href=e:location.assign(e),n=null},t.readAsDataURL(e)}else{const t=URL.createObjectURL(e);n?n.location.assign(t):location.href=t,n=null,setTimeout(function(){URL.revokeObjectURL(t)},4e4)}}:()=>{};const{assign:N}=Object;const V=()=>{};function k(e,t,r,a=V){e.add(t);const s=()=>{e.delete(t)&&a()};return!r&&(0,n.getCurrentScope)()&&(0,n.onScopeDispose)(s),s}function S(e,...t){e.forEach(e=>{e(...t)})}const w=e=>e(),B=Symbol(),x=Symbol();function D(e,t){e instanceof Map&&t instanceof Map?t.forEach((t,r)=>e.set(r,t)):e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const r in t){if(!t.hasOwnProperty(r))continue;const a=t[r],s=e[r];p(s)&&p(a)&&e.hasOwnProperty(r)&&!(0,n.isRef)(a)&&!(0,n.isReactive)(a)?e[r]=D(s,a):e[r]=a}return e}const C=Symbol();function j(e){return!p(e)||!Object.prototype.hasOwnProperty.call(e,C)}const{assign:I}=Object;function A(e){return!(!(0,n.isRef)(e)||!e.effect)}function O(e,t,r={},a,s,l){let i;const o=I({actions:{}},r);const c={deep:!0};let d,p;let f,g=new Set,b=new Set;const v=a.state.value[e];l||v||(a.state.value[e]={});(0,n.ref)({});let h;function y(t){let r;d=p=!1,'function'==typeof t?(t(a.state.value[e]),r={type:m.patchFunction,storeId:e,events:f}):(D(a.state.value[e],t),r={type:m.patchObject,payload:t,storeId:e,events:f});const s=h=Symbol();(0,n.nextTick)().then(()=>{h===s&&(d=!0)}),p=!0,S(g,r,a.state.value[e])}const E=l?function(){const{state:e}=r,t=e?e():{};this.$patch(e=>{I(e,t)})}:V;const N=(t,r='')=>{if(B in t)return t[x]=r,t;const n=function(){u(a);const r=Array.from(arguments),s=new Set,l=new Set;let i;S(b,{args:r,name:n[x],store:O,after:function(e){s.add(e)},onError:function(e){l.add(e)}});try{i=t.apply(this&&this.$id===e?this:O,r)}catch(e){throw S(l,e),e}return i instanceof Promise?i.then(e=>(S(s,e),e)).catch(e=>(S(l,e),Promise.reject(e))):(S(s,i),i)};return n[B]=!0,n[x]=r,n},C={_p:a,$id:e,$onAction:k.bind(null,b),$patch:y,$reset:E,$subscribe(t,r={}){const s=k(g,t,r.detached,()=>l()),l=i.run(()=>(0,n.watch)(()=>a.state.value[e],n=>{('sync'===r.flush?p:d)&&t({storeId:e,type:m.direct,events:f},n)},I({},c,r)));return s},$dispose:function(){i.stop(),g.clear(),b.clear(),a._s.delete(e)}},O=(0,n.reactive)(C);a._s.set(e,O);const M=(a._a&&a._a.runWithContext||w)(()=>a._e.run(()=>(i=(0,n.effectScope)()).run(()=>t({action:N}))));for(const t in M){const r=M[t];if((0,n.isRef)(r)&&!A(r)||(0,n.isReactive)(r))l||(v&&j(r)&&((0,n.isRef)(r)?r.value=v[t]:D(r,v[t])),a.state.value[e][t]=r);else if('function'==typeof r){const e=N(r,t);M[t]=e,o.actions[t]=r}else 0}return I(O,M),I((0,n.toRaw)(O),M),Object.defineProperty(O,'$state',{get:()=>a.state.value[e],set:e=>{y(t=>{I(t,e)})}}),a._p.forEach(e=>{I(O,i.run(()=>e({store:O,app:a._a,pinia:a,options:o})))}),v&&l&&r.hydrate&&r.hydrate(O.$state,v),d=!0,p=!0,O}const M=i.parse({}),L=function(e,t,r){let a;const s='function'==typeof t;function l(r,l){const i=(0,n.hasInjectionContext)();(r=r||(i?(0,n.inject)(d,null):null))&&u(r),(r=c)._s.has(e)||(s?O(e,t,a,r):function(e,t,r){const{state:a,actions:s,getters:l}=t,i=r.state.value[e];let o;o=O(e,function(){i||(r.state.value[e]=a?a():{});const t=(0,n.toRefs)(r.state.value[e]);return I(t,s,Object.keys(l||{}).reduce((t,a)=>(t[a]=(0,n.markRaw)((0,n.computed)(()=>{u(r);const t=r._s.get(e);return l[a].call(t,t)})),t),{}))},t,r,0,!0)}(e,a,r));return r._s.get(e)}return a=s?r:t,l.$id=e,l}('data',errorCatched(()=>{const e=getCurrentMessageId(),t=(0,n.ref)(M),r=()=>{try{const r=(()=>{const t=Mvu.getMvuData({type:'message',message_id:e});return i.parse(_.get(t,'stat_data',{}))})();_.isEqual(r,t.value)||(t.value=r)}catch{}};return(async()=>{await waitGlobalInitialized('Mvu'),r(),eventOn(Mvu.events.VARIABLE_UPDATE_ENDED,r),eventOn(Mvu.events.VARIABLE_INITIALIZED,r)})(),{data:t}})),T={id:'characters-section',class:'section'},R={class:'status-tabs-container'},P={class:'tab-buttons'},U=['onClick'],X={class:'status-grid'},F={class:'status-item health-section'},W={class:'health-section-header'},H={class:'value'},J={class:'health-status-subtext'},G={class:'progress-bar-container'},K={class:'value-subtext'},Y={class:'status-item imprint-section'},q={class:'health-section-header'},Z={class:'value'},Q={class:'imprint-status-subtext'},ee={class:'progress-bar-container imprint-bar'},te={class:'value-subtext imprint-change'},re={class:'value-subtext imprint-hint'},ne={class:'details-grid'},ae={class:'status-item'},se={class:'value'},le={class:'status-item'},ie={class:'value'},oe={class:'status-item'},ce={class:'value'},ue={class:'status-item'},de={class:'value'},pe={class:'status-item'},me={class:'value'},fe={class:'status-item'},ge={class:'value'},be={class:'status-item'},ve={class:'value thought-text'},ze={key:1,class:'content-text'},he=(0,n.defineComponent)({__name:'CharactersSection',setup(e){const t=['浅见亚美','相田哲也','星野琉璃','早川遥','早川舞','藤井雪乃','中村惠子','爱宫心爱','爱宫铃','桃乐丝・泽巴哈','何铃','王静','康绮月','薛萍','小泽花'],r=L(),a=(0,n.computed)(()=>{const e=[],n=e=>'登场'===i(e)?.登场状态,a=t.filter(e=>r.data[e]),s=a.filter(n),l=a.filter(e=>!n(e));e.push(...s,...l);const o=r.data.临时NPC;if(o&&'object'==typeof o){const t=Object.keys(o).sort(),r=t.filter(e=>n(`临时NPC:${e}`)),a=t.filter(e=>!n(`临时NPC:${e}`));r.forEach(t=>e.push(`临时NPC:${t}`)),a.forEach(t=>e.push(`临时NPC:${t}`))}return e}),l=(0,n.ref)(null);function i(e){const t='string'==typeof e?e.replace(/\?/g,'・'):e;if('string'==typeof e&&e.startsWith('临时NPC:')){const t=e.split(':')[1];return r.data.临时NPC[t]}return r.data[t]}function o(e){const t=i(e);return t&&t.健康更新原因?t.健康更新原因:''}function c(e){const t=i(e),r='string'==typeof t?.姓名?t.姓名.trim():'';return'string'==typeof e&&e.startsWith('临时NPC:')?e.split(':')[1]:r||e}function u(e){const t=i(e);return t?.登场状态??'离场'}function d(e){const t=i(e),r=t?.健康;return'number'!=typeof r?0:s().clamp(r,0,100)}function p(e){const t=i(e),r=t?.秩序刻印;return'number'!=typeof r?0:s().clamp(r,0,100)}function m(e){const t=i(e);if(t?.关系)return t.关系;const r='number'==typeof t?.秩序刻印?t.秩序刻印:null;return null===r?'未知':r<20?'拒绝':r<40?'交易':r<60?'顺从':r<90?'忠诚':'性奴'}function f(e){const t=i(e);return t?.关系倾向??'未知'}function g(e){switch(m(e)){case'拒绝':return'0 - 19';case'交易':return'20 - 39';case'顺从':return'40 - 59';case'忠诚':return'60 - 89';case'性奴':return'90 - 100';default:return'0 - 100'}}function b(e){const t=i(e);return t?.秩序刻印更新原因??''}return(0,n.watch)(a,e=>{0!==e.length?l.value&&e.includes(l.value)||(l.value=e[0]):l.value=null},{immediate:!0}),(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)('section',T,[t[9]||(t[9]=(0,n.createElementVNode)('h2',{class:'section-title'},'👤 登场角色 👤',-1)),(0,n.createElementVNode)('div',R,[(0,n.unref)(a).length>0?((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:0},[(0,n.createElementVNode)('div',P,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(a),e=>((0,n.openBlock)(),(0,n.createElementBlock)('button',{key:e,class:(0,n.normalizeClass)(['tab-button',{active:(0,n.unref)(l)===e}]),type:'button',onClick:t=>function(e){l.value=e}(e)},[(0,n.createTextVNode)((0,n.toDisplayString)(c(e))+' ',1),(0,n.createElementVNode)('span',{class:(0,n.normalizeClass)(['status-pill',u(e)])},(0,n.toDisplayString)(u(e)),3)],10,U))),128))]),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(a),e=>(0,n.withDirectives)(((0,n.openBlock)(),(0,n.createElementBlock)('div',{key:`${e}:tab`,class:(0,n.normalizeClass)(['tab-content',{active:(0,n.unref)(l)===e}])},[(0,n.createElementVNode)('div',X,[(0,n.createElementVNode)('div',F,[(0,n.createElementVNode)('div',W,[t[0]||(t[0]=(0,n.createElementVNode)('div',{class:'label'},'❤️ 健康',-1)),(0,n.createElementVNode)('div',H,(0,n.toDisplayString)(i(e)?.健康??'--'),1)]),(0,n.createElementVNode)('div',J,(0,n.toDisplayString)(i(e)?.健康状况??'--'),1),(0,n.createElementVNode)('div',G,[(0,n.createElementVNode)('div',{class:'progress-bar-value',style:(0,n.normalizeStyle)({width:`${d(e)}%`})},null,4)]),(0,n.createElementVNode)('div',K,(0,n.toDisplayString)(o(e)),1)]),(0,n.createElementVNode)('div',Y,[(0,n.createElementVNode)('div',q,[t[1]||(t[1]=(0,n.createElementVNode)('div',{class:'label'},'🔱 秩序刻印',-1)),(0,n.createElementVNode)('div',Z,(0,n.toDisplayString)(i(e)?.秩序刻印??'--'),1)]),(0,n.createElementVNode)('div',Q,(0,n.toDisplayString)(m(e))+' · 关系倾向：'+(0,n.toDisplayString)(f(e)),1),(0,n.createElementVNode)('div',ee,[(0,n.createElementVNode)('div',{class:'progress-bar-value',style:(0,n.normalizeStyle)({width:`${p(e)}%`})},null,4)]),(0,n.createElementVNode)('div',te,(0,n.toDisplayString)(b(e)||' '),1),(0,n.createElementVNode)('div',re,' 区间：'+(0,n.toDisplayString)(g(e))+'｜数值越高表示更深的秩序绑定 ',1)]),(0,n.createElementVNode)('div',ne,[(0,n.createElementVNode)('div',ae,[t[2]||(t[2]=(0,n.createElementVNode)('div',{class:'label'},'👚 衣着',-1)),(0,n.createElementVNode)('div',se,(0,n.toDisplayString)(i(e)?.衣着??'--'),1)]),(0,n.createElementVNode)('div',le,[t[3]||(t[3]=(0,n.createElementVNode)('div',{class:'label'},'👅 舌唇',-1)),(0,n.createElementVNode)('div',ie,(0,n.toDisplayString)(i(e)?.舌唇??'--'),1)]),(0,n.createElementVNode)('div',oe,[t[4]||(t[4]=(0,n.createElementVNode)('div',{class:'label'},'🍈 胸乳',-1)),(0,n.createElementVNode)('div',ce,(0,n.toDisplayString)(i(e)?.胸乳??'--'),1)]),(0,n.createElementVNode)('div',ue,[t[5]||(t[5]=(0,n.createElementVNode)('div',{class:'label'},'🌸 私穴',-1)),(0,n.createElementVNode)('div',de,(0,n.toDisplayString)(i(e)?.私穴??'--'),1)]),(0,n.createElementVNode)('div',pe,[t[6]||(t[6]=(0,n.createElementVNode)('div',{class:'label'},'😊 神态样貌',-1)),(0,n.createElementVNode)('div',me,(0,n.toDisplayString)(i(e)?.神态样貌??'--'),1)]),(0,n.createElementVNode)('div',fe,[t[7]||(t[7]=(0,n.createElementVNode)('div',{class:'label'},'💃 动作姿势',-1)),(0,n.createElementVNode)('div',ge,(0,n.toDisplayString)(i(e)?.动作姿势??'--'),1)])]),(0,n.createElementVNode)('div',be,[t[8]||(t[8]=(0,n.createElementVNode)('div',{class:'label'},'💭 内心想法',-1)),(0,n.createElementVNode)('div',ve,(0,n.toDisplayString)(i(e)?.内心想法??'--'),1)])])],2)),[[n.vShow,(0,n.unref)(l)===e]])),128))],64)):((0,n.openBlock)(),(0,n.createElementBlock)('div',ze,'暂无登场角色'))])]))}});var ye=r(455);const Ee=(0,ye.A)(he,[['__scopeId','data-v-054f603c']]);function Ne(e){return!!(0,n.getCurrentScope)()&&((0,n.onScopeDispose)(e),!0)}const Ve='undefined'!=typeof window&&'undefined'!=typeof document,ke=('undefined'!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope),Object.prototype.toString),Se=e=>'[object Object]'===ke.call(e),we=()=>{};function Be(...e){if(1!==e.length)return(0,n.toRef)(...e);const t=e[0];return'function'==typeof t?(0,n.readonly)((0,n.customRef)(()=>({get:t,set:we}))):(0,n.ref)(t)}function _e(e,t){return function(...r){return new Promise((n,a)=>{Promise.resolve(e(()=>t.apply(this,r),{fn:t,thisArg:this,args:r})).then(n).catch(a)})}}const xe=e=>e();function De(e,t={}){let r,a,s=we;const l=e=>{clearTimeout(e),s(),s=we};let i;return o=>{const c=(0,n.toValue)(e),u=(0,n.toValue)(t.maxWait);return r&&l(r),c<=0||void 0!==u&&u<=0?(a&&(l(a),a=void 0),Promise.resolve(o())):new Promise((e,n)=>{s=t.rejectOnCancel?n:e,i=o,u&&!a&&(a=setTimeout(()=>{r&&l(r),a=void 0,e(i())},u)),r=setTimeout(()=>{a&&l(a),a=void 0,e(o())},c)})}}function Ce(e){return Array.isArray(e)?e:[e]}function je(e){const t=Object.create(null);return r=>t[r]||(t[r]=e(r))}const Ie=/\B([A-Z])/g,Ae=(je(e=>e.replace(Ie,'-$1').toLowerCase()),/-(\w)/g);je(e=>e.replace(Ae,(_,e)=>e?e.toUpperCase():''));function Oe(e){return e||(0,n.getCurrentInstance)()}function Me(e,t,r={}){const{eventFilter:a=xe,...s}=r;return(0,n.watch)(e,_e(a,t),s)}function $e(e,t,r={}){const{eventFilter:a,initialState:s='active',...l}=r,{eventFilter:i,pause:o,resume:c,isActive:u}=function(e=xe,t={}){const{initialState:r='active'}=t,a=Be('active'===r);return{isActive:(0,n.readonly)(a),pause:function(){a.value=!1},resume:function(){a.value=!0},eventFilter:(...t)=>{a.value&&e(...t)}}}(a,{initialState:s});return{stop:Me(e,t,{...l,eventFilter:i}),pause:o,resume:c,isActive:u}}const Le=Ve?window:void 0;Ve&&window.document,Ve&&window.navigator,Ve&&window.location;function Te(e){var t;const r=(0,n.toValue)(e);return null!=(t=null==r?void 0:r.$el)?t:r}function Re(...e){const t=[],r=()=>{t.forEach(e=>e()),t.length=0},a=(0,n.computed)(()=>{const t=Ce((0,n.toValue)(e[0])).filter(e=>null!=e);return t.every(e=>'string'!=typeof e)?t:void 0}),s=(l=()=>{var t,r;return[null!=(r=null==(t=a.value)?void 0:t.map(e=>Te(e)))?r:[Le].filter(e=>null!=e),Ce((0,n.toValue)(a.value?e[1]:e[0])),Ce((0,n.unref)(a.value?e[2]:e[1])),(0,n.toValue)(a.value?e[3]:e[2])]},i=([e,n,a,s])=>{if(r(),!(null==e?void 0:e.length)||!(null==n?void 0:n.length)||!(null==a?void 0:a.length))return;const l=Se(s)?{...s}:s;t.push(...e.flatMap(e=>n.flatMap(t=>a.map(r=>((e,t,r,n)=>(e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)))(e,t,r,l)))))},o={flush:'post'},(0,n.watch)(l,i,{...o,immediate:!0}));var l,i,o;return Ne(r),()=>{s(),r()}}Symbol('vueuse-ssr-width');const Pe='undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:'undefined'!=typeof globalThis?globalThis:'undefined'!=typeof self?self:{},Ue='__vueuse_ssr_handlers__',Xe=Fe();function Fe(){return Ue in Pe||(Pe[Ue]=Pe[Ue]||{}),Pe[Ue]}function We(e,t){return Xe[e]||t}function He(e){return null==e?'any':e instanceof Set?'set':e instanceof Map?'map':e instanceof Date?'date':'boolean'==typeof e?'boolean':'string'==typeof e?'string':'object'==typeof e?'object':Number.isNaN(e)?'any':'number'}const Je={boolean:{read:e=>'true'===e,write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},Ge='vueuse-storage';function Ke(e,t,r,a={}){var s;const{flush:l='pre',deep:i=!0,listenToStorageChanges:o=!0,writeDefaults:c=!0,mergeDefaults:u=!1,shallow:d,window:p=Le,eventFilter:m,onError:f=e=>{console.error(e)},initOnMounted:g}=a,b=(d?n.shallowRef:n.ref)('function'==typeof t?t():t),v=(0,n.computed)(()=>(0,n.toValue)(e));if(!r)try{r=We('getDefaultStorage',()=>{var e;return null==(e=Le)?void 0:e.localStorage})()}catch(e){f(e)}if(!r)return b;const h=(0,n.toValue)(t),y=He(h),E=null!=(s=a.serializer)?s:Je[y],{pause:N,resume:V}=$e(b,e=>function(e){try{const t=r.getItem(v.value);if(null==e)w(t,null),r.removeItem(v.value);else{const n=E.write(e);t!==n&&(r.setItem(v.value,n),w(t,n))}}catch(e){f(e)}}(e),{flush:l,deep:i,eventFilter:m});(0,n.watch)(v,()=>B(),{flush:l});let k=!1;const S=e=>{g&&!k||B(e.detail)};function w(e,t){if(p){const n={key:v.value,oldValue:e,newValue:t,storageArea:r};p.dispatchEvent(r instanceof Storage?new StorageEvent('storage',n):new CustomEvent(Ge,{detail:n}))}}function B(e){if(!e||e.storageArea===r)if(e&&null==e.key)b.value=h;else if(!e||e.key===v.value){N();try{const t=E.write(b.value);void 0!==e&&(null==e?void 0:e.newValue)===t||(b.value=function(e){const t=e?e.newValue:r.getItem(v.value);if(null==t)return c&&null!=h&&r.setItem(v.value,E.write(h)),h;if(!e&&u){const e=E.read(t);return'function'==typeof u?u(e,h):'object'!==y||Array.isArray(e)?e:{...h,...e}}return'string'!=typeof t?t:E.read(t)}(e))}catch(e){f(e)}finally{e?(0,n.nextTick)(V):V()}}}return p&&o&&(r instanceof Storage?Re(p,'storage',e=>{g&&!k||B(e)},{passive:!0}):Re(p,Ge,S)),g?function(e,t=!0,r){Oe(r)?(0,n.onMounted)(e,r):t?e():(0,n.nextTick)(e)}(()=>{k=!0,B()}):B(),b}function Ye(e,t,r={}){const{window:n=Le}=r;return Ke(e,t,null==n?void 0:n.localStorage,r)}Number.POSITIVE_INFINITY;const qe={class:'section'},Ze=['onClick'],Qe={key:1,class:'choice-item',type:'button',disabled:''},et={class:'palette-option'},tt={class:'palette-option'},rt={class:'palette-option'},nt={class:'palette-buttons'},at='ui_settings',st=(0,n.defineComponent)({__name:'ChoicesSection',props:{options:{}},setup(e){const t=e,r=(0,n.ref)(!1),a=Ye('eden_theme','apocalypse_tech'),s=Ye('eden_font_key','yahei'),l=Ye('eden_font_size_key','16');(0,n.watch)([a,s,l],([e,t,r])=>{updateVariablesWith(n=>(_.set(n,at,{theme:e,font_key:t,font_size:r}),n),{type:'chat'})},{immediate:!1});const i=(0,n.ref)(null),o=(0,n.ref)(null);function c(){r.value=!r.value}function u(e){if(!r.value)return;const t=e.target;t&&(o.value?.contains(t)||i.value?.contains(t)||(r.value=!1))}return(0,n.watch)(a,e=>{'apocalypse_tech'!==e?document.documentElement.dataset.theme=e:delete document.documentElement.dataset.theme},{immediate:!0}),(0,n.watch)(s,e=>{const t=document.getElementById('eden-main-container');if(!t)return;const r={yahei:'"Microsoft YaHei", sans-serif',simsun:'SimSun, serif',kaiti:'KaiTi, serif'};t.style.fontFamily=r[e]||r.yahei},{immediate:!0}),(0,n.watch)(l,e=>{const t=document.getElementById('eden-main-container');t&&t.style.setProperty('--font-size-main',`${e}px`)},{immediate:!0}),(0,n.onMounted)(()=>{!function(){const e=getVariables({type:'chat'})??{},t=_.get(e,at,{});'string'==typeof t.theme&&(a.value=t.theme),'string'==typeof t.font_key&&(s.value=t.font_key),'string'==typeof t.font_size&&(l.value=t.font_size)}(),document.addEventListener('click',u)}),(0,n.onBeforeUnmount)(()=>{document.removeEventListener('click',u)}),(e,u)=>((0,n.openBlock)(),(0,n.createElementBlock)('section',qe,[(0,n.createElementVNode)('button',{ref_key:'palette_button',ref:i,class:'palette-button',type:'button',onClick:(0,n.withModifiers)(c,['stop'])},'🎨',512),u[11]||(u[11]=(0,n.createElementVNode)('h2',{class:'section-title choices-title'},'⚜️ 快速剧情 ⚜️',-1)),(0,n.createElementVNode)('div',null,[t.options.length>0?((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:0},(0,n.renderList)(t.options,(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)('button',{key:t,class:'choice-item',type:'button',onClick:t=>function(e){if('function'==typeof triggerSlash)try{return void triggerSlash(`/send ${e} | /trigger await=true`)}catch{return void alert(`指令发送失败: ${e}`)}alert(`无法自动发送: ${e}`)}(e)},(0,n.toDisplayString)(e),9,Ze))),128)):((0,n.openBlock)(),(0,n.createElementBlock)('button',Qe,'当前无选项，请自由行动...'))]),(0,n.createElementVNode)('div',{ref_key:'palette_modal',ref:o,class:(0,n.normalizeClass)(['palette-modal',{show:(0,n.unref)(r)}])},[u[10]||(u[10]=(0,n.createElementVNode)('h3',null,'显示设置',-1)),(0,n.createElementVNode)('div',et,[u[5]||(u[5]=(0,n.createElementVNode)('label',null,'🎨 主题',-1)),(0,n.withDirectives)((0,n.createElementVNode)('select',{'onUpdate:modelValue':u[0]||(u[0]=e=>(0,n.isRef)(a)?a.value=e:null)},[...u[4]||(u[4]=[(0,n.createElementVNode)('option',{value:'apocalypse_tech'},'末日科技 (默认)',-1),(0,n.createElementVNode)('option',{value:'jade_green'},'淡翡翠绿',-1),(0,n.createElementVNode)('option',{value:'parchment'},'复古羊皮纸',-1),(0,n.createElementVNode)('option',{value:'milky'},'清新奶白',-1)])],512),[[n.vModelSelect,(0,n.unref)(a)]])]),(0,n.createElementVNode)('div',tt,[u[7]||(u[7]=(0,n.createElementVNode)('label',null,'🖋️ 字体',-1)),(0,n.withDirectives)((0,n.createElementVNode)('select',{'onUpdate:modelValue':u[1]||(u[1]=e=>(0,n.isRef)(s)?s.value=e:null)},[...u[6]||(u[6]=[(0,n.createElementVNode)('option',{value:'yahei'},'微软雅黑 (默认)',-1),(0,n.createElementVNode)('option',{value:'simsun'},'宋体',-1),(0,n.createElementVNode)('option',{value:'kaiti'},'楷体',-1)])],512),[[n.vModelSelect,(0,n.unref)(s)]])]),(0,n.createElementVNode)('div',rt,[u[9]||(u[9]=(0,n.createElementVNode)('label',null,'↔️ 字体大小',-1)),(0,n.withDirectives)((0,n.createElementVNode)('select',{'onUpdate:modelValue':u[2]||(u[2]=e=>(0,n.isRef)(l)?l.value=e:null)},[...u[8]||(u[8]=[(0,n.createStaticVNode)('<option value="12">12px (最小)</option><option value="14">14px (较小)</option><option value="15">15px (稍小)</option><option value="16">16px (默认)</option><option value="18">18px (稍大)</option><option value="20">20px (较大)</option><option value="22">22px (很大)</option><option value="24">24px (最大)</option>',8)])],512),[[n.vModelSelect,(0,n.unref)(l)]])]),(0,n.createElementVNode)('div',nt,[(0,n.createElementVNode)('button',{class:'palette-close',type:'button',onClick:u[3]||(u[3]=e=>r.value=!1)},'关闭')])],2)]))}}),lt={id:'mission-section',class:'section'},it={class:'mission-content'},ot={class:'mission-phase'},ct={class:'phase-name'},ut={class:'goals-progress-bar'},dt={class:'progress-header'},pt={class:'progress-text'},mt={class:'progress-track'},ft={class:'mission-goals'},gt={class:'toggle-icon'},bt={class:'goals-count'},vt={class:'goals-list'},zt={class:'goal-checkbox'},ht={key:0,viewBox:'0 0 24 24',class:'check-icon'},yt={key:1,viewBox:'0 0 24 24',class:'check-icon empty'},Et={class:'goal-content'},Nt={key:0,class:'goal-meta'},Vt={class:'meta-chip'},kt={key:1,class:'goal-status-tag'},St={key:1,class:'goal-item empty'},wt={class:'mission-intel'},Bt={class:'toggle-icon'},_t={class:'intel-count'},xt={key:0,class:'intel-empty-hint'},Dt={class:'intel-list'},Ct={viewBox:'0 0 36 36',class:'progress-ring'},jt=['stroke-dasharray'],It={class:'ring-icon'},At={class:'intel-content'},Ot={class:'intel-header'},Mt={class:'intel-id'},$t={class:'intel-desc'},Lt={class:'intel-meta'},Tt={class:'intel-value'},Rt={class:'intel-risk'},Pt={key:1,class:'intel-item empty'},Ut=(0,n.defineComponent)({__name:'MissionSection',setup(e){const t=L(),r=(0,n.ref)(!1),a=(0,n.ref)(!1),s=(0,n.computed)(()=>{const e=t.data.主线任务.阶段目标;return Array.isArray(e)?e.map((e,t)=>({key:String(t),描述:e?.描述??'',当前值:Number(e?.当前值??0),目标值:Number(e?.目标值??0)})):Object.entries(e??{}).map(([e,t])=>({key:e,描述:t?.描述??e,当前值:Number(t?.当前值??0),目标值:Number(t?.目标值??0)}))}),l=(0,n.computed)(()=>s.value.filter((e,t)=>o(e.key,t)).length),i=(0,n.computed)(()=>{const e=s.value.length;return 0===e?0:Math.round(l.value/e*100)});function o(e,r){const n=t.data.主线任务.目标完成状态??{};if(e in n)return!0===n[e];return!0===n[String(r)]}function c(e){return e?'string'==typeof e?e:'object'==typeof e&&'描述'in e?e.描述:String(e):''}function u(e){return e&&'object'==typeof e&&void 0!==e.当前值&&void 0!==e.目标值}const d=(0,n.computed)(()=>Object.keys(t.data.主线任务.情报碎片).length),p=(0,n.computed)(()=>Object.values(t.data.主线任务.情报碎片).filter(e=>'已完成'===e.状态).length);function m(e){switch(e){case'已完成':return'✓';case'已探索':return'◐';default:return'○'}}function f(e){let t=33;switch(e){case'已完成':t=100;break;case'已探索':t=66;break;case'未探索':t=33}const r=2*Math.PI*16;return`${t} ${r} ${r-t/100*r}`}return(e,g)=>((0,n.openBlock)(),(0,n.createElementBlock)('section',lt,[g[9]||(g[9]=(0,n.createElementVNode)('h2',{class:'section-title'},'📜 主线任务 📜',-1)),(0,n.createElementVNode)('div',it,[(0,n.createCommentVNode)(' 当前阶段 '),(0,n.createElementVNode)('div',ot,[g[2]||(g[2]=(0,n.createElementVNode)('div',{class:'phase-label'},'📍 当前阶段',-1)),(0,n.createElementVNode)('div',ct,(0,n.toDisplayString)((0,n.unref)(t).data.主线任务.当前阶段),1)]),(0,n.createCommentVNode)(' 阶段目标进度条 '),(0,n.createElementVNode)('div',ut,[(0,n.createElementVNode)('div',dt,[g[3]||(g[3]=(0,n.createElementVNode)('span',null,'🎯 阶段目标进度',-1)),(0,n.createElementVNode)('span',pt,(0,n.toDisplayString)(l.value)+'/'+(0,n.toDisplayString)(s.value.length),1)]),(0,n.createElementVNode)('div',mt,[(0,n.createElementVNode)('div',{class:'progress-fill',style:(0,n.normalizeStyle)({width:i.value+'%'})},null,4)])]),(0,n.createCommentVNode)(' 阶段目标 '),(0,n.createElementVNode)('div',ft,[(0,n.createElementVNode)('button',{class:'collapse-toggle-btn',onClick:g[0]||(g[0]=e=>r.value=!r.value)},[(0,n.createElementVNode)('span',gt,(0,n.toDisplayString)(r.value?'▼':'▶'),1),g[4]||(g[4]=(0,n.createElementVNode)('span',{class:'toggle-text'},'📋 目标清单',-1)),(0,n.createElementVNode)('span',bt,'('+(0,n.toDisplayString)(l.value)+'/'+(0,n.toDisplayString)((0,n.unref)(t).data.主线任务.阶段目标.length)+')',1)]),(0,n.withDirectives)((0,n.createElementVNode)('div',vt,[s.value.length>0?((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:0},(0,n.renderList)(s.value,(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)('div',{key:e.key||t,class:(0,n.normalizeClass)(['goal-item',{completed:o(e.key,t)}])},[(0,n.createElementVNode)('div',zt,[o(e.key,t)?((0,n.openBlock)(),(0,n.createElementBlock)('svg',ht,[...g[5]||(g[5]=[(0,n.createElementVNode)('path',{d:'M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z'},null,-1)])])):((0,n.openBlock)(),(0,n.createElementBlock)('svg',yt,[...g[6]||(g[6]=[(0,n.createElementVNode)('circle',{cx:'12',cy:'12',r:'10'},null,-1)])]))]),(0,n.createElementVNode)('div',Et,[(0,n.createElementVNode)('div',{class:(0,n.normalizeClass)(['goal-text',{completed:o(e.key,t)}])},(0,n.toDisplayString)(c(e)),3),u(e)?((0,n.openBlock)(),(0,n.createElementBlock)('div',Nt,[(0,n.createElementVNode)('span',Vt,'进度：'+(0,n.toDisplayString)(e.当前值??0)+'/'+(0,n.toDisplayString)(e.目标值??0),1)])):(0,n.createCommentVNode)('v-if',!0),o(e.key,t)?((0,n.openBlock)(),(0,n.createElementBlock)('span',kt,'已完成')):(0,n.createCommentVNode)('v-if',!0)])],2))),128)):((0,n.openBlock)(),(0,n.createElementBlock)('div',St,'(暂无目标)'))],512),[[n.vShow,r.value]])]),(0,n.createCommentVNode)(' 情报碎片 '),(0,n.createElementVNode)('div',wt,[(0,n.createElementVNode)('button',{class:'collapse-toggle-btn',onClick:g[1]||(g[1]=e=>a.value=!a.value)},[(0,n.createElementVNode)('span',Bt,(0,n.toDisplayString)(a.value?'▼':'▶'),1),g[7]||(g[7]=(0,n.createElementVNode)('span',{class:'toggle-text'},'🔍 情报碎片',-1)),(0,n.createElementVNode)('span',_t,'('+(0,n.toDisplayString)(p.value)+'/'+(0,n.toDisplayString)(d.value)+')',1)]),0===d.value?((0,n.openBlock)(),(0,n.createElementBlock)('div',xt,'暂无情报碎片，继续探索/搜刮可解锁新的线索。')):(0,n.createCommentVNode)('v-if',!0),(0,n.withDirectives)((0,n.createElementVNode)('div',Dt,[d.value>0?((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:0},(0,n.renderList)((0,n.unref)(t).data.主线任务.情报碎片,(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)('div',{key:t,class:(0,n.normalizeClass)(['intel-item',e.状态])},[(0,n.createElementVNode)('div',{class:(0,n.normalizeClass)(['intel-status-ring',e.状态])},[((0,n.openBlock)(),(0,n.createElementBlock)('svg',Ct,[g[8]||(g[8]=(0,n.createElementVNode)('circle',{cx:'18',cy:'18',r:'16',class:'ring-bg'},null,-1)),(0,n.createElementVNode)('circle',{cx:'18',cy:'18',r:'16',class:(0,n.normalizeClass)(['ring-progress',e.状态]),'stroke-dasharray':f(e.状态)},null,10,jt)])),(0,n.createElementVNode)('span',It,(0,n.toDisplayString)(m(e.状态)),1)],2),(0,n.createElementVNode)('div',At,[(0,n.createElementVNode)('div',Ot,[(0,n.createElementVNode)('span',Mt,(0,n.toDisplayString)(e.编号),1),(0,n.createElementVNode)('span',{class:(0,n.normalizeClass)(['intel-status-badge',e.状态])},(0,n.toDisplayString)(e.状态),3)]),(0,n.createElementVNode)('div',$t,(0,n.toDisplayString)(e.描述),1),(0,n.createElementVNode)('div',Lt,[(0,n.createElementVNode)('span',Tt,'💰 '+(0,n.toDisplayString)(e.价值),1),(0,n.createElementVNode)('span',Rt,'⚠️ '+(0,n.toDisplayString)(e.风险),1)])])],2))),128)):((0,n.openBlock)(),(0,n.createElementBlock)('div',Pt,'(暂无情报碎片)'))],512),[[n.vShow,a.value]])])])]))}}),Xt=(0,ye.A)(Ut,[['__scopeId','data-v-15f30780']]),Ft={class:'section',id:'other-residents-section'},Wt={class:'other-residents-item'},Ht={class:'value'},Jt={class:'other-residents-item'},Gt={class:'value'},Kt=(0,n.defineComponent)({__name:'OtherResidentsSection',setup(e){const t=L();return(e,r)=>((0,n.openBlock)(),(0,n.createElementBlock)('section',Ft,[r[2]||(r[2]=(0,n.createElementVNode)('h2',{class:'section-title'},'🏢 其他楼层情况 🏢',-1)),(0,n.createElementVNode)('div',Wt,[r[0]||(r[0]=(0,n.createElementVNode)('div',{class:'label'},'💬 楼层言语',-1)),(0,n.createElementVNode)('div',Ht,(0,n.toDisplayString)((0,n.unref)(t).data.楼层其他住户.言语),1)]),(0,n.createElementVNode)('div',Jt,[r[1]||(r[1]=(0,n.createElementVNode)('div',{class:'label'},'🏃 楼层行为',-1)),(0,n.createElementVNode)('div',Gt,(0,n.toDisplayString)((0,n.unref)(t).data.楼层其他住户.行为),1)])]))}}),Yt={id:'shelter-section',class:'section'},qt={class:'shelter-grid'},Zt={class:'shelter-item'},Qt={class:'value'},er={class:'shelter-item'},tr={class:'value'},rr={class:'shelter-item'},nr={class:'value'},ar={class:'shelter-item'},sr={class:'expansion-list'},lr={class:'status'},ir={class:'status'},or={class:'status'},cr={class:'shelter-item'},ur={class:'toggle-icon'},dr={class:'toggle-text'},pr={class:'map-container'},mr={class:'map-zone'},fr={class:'room-grid entrance-grid'},gr={class:'room-cell highlight'},br={class:'room-value'},vr={class:'room-value'},zr={class:'room-resident'},hr={class:'room-value'},yr={class:'room-resident'},Er={class:'map-zone'},Nr={class:'room-grid core-grid'},Vr={class:'room-value'},kr={class:'room-resident'},Sr={class:'room-value'},wr={class:'room-resident'},Br={class:'map-zone'},_r={class:'room-grid floor-grid'},xr={class:'room-number'},Dr={class:'room-value'},Cr={class:'room-resident'},jr={class:'map-zone'},Ir={class:'room-grid floor-grid'},Ar={class:'room-number'},Or={class:'room-value'},Mr={class:'room-resident'},$r={class:'shelter-item'},Lr={class:'toggle-icon'},Tr={class:'ability-list'},Rr={class:'name'},Pr={class:'desc'},Ur=(0,n.defineComponent)({__name:'ShelterSection',setup(e){const t=L(),r=(0,n.ref)(!1),a=(0,n.ref)(!1),s=(0,n.computed)(()=>{const e=t.data.庇护所.庇护所能力;return Array.isArray(e)?e:Object.entries(e??{}).map(([e,t])=>({name:e,desc:t?.desc??''}))}),l=[{number:'2001'},{number:'2002'},{number:'2003'},{number:'2004'},{number:'2005'},{number:'2006'},{number:'2007'},{number:'2008'},{number:'2009'},{number:'2010'},{number:'2011'},{number:'2012'}],i=[{number:'1901'},{number:'1902'},{number:'1903'},{number:'1904'},{number:'1905'},{number:'1906'},{number:'1907'},{number:'1908'},{number:'1909'},{number:'1910'},{number:'1911'},{number:'1912'}],o=(0,n.computed)(()=>t.data.房间.玄关.临时客房A入住者.length>0),c=(0,n.computed)(()=>t.data.房间.玄关.临时客房B入住者.length>0);function u(e){const r='A'===e?t.data.房间.玄关.临时客房A入住者:t.data.房间.玄关.临时客房B入住者;return r.length>0?r.join('、'):'-'}const d=(0,n.computed)(()=>t.data.房间.核心区.主卧室使用者.length>0),p=(0,n.computed)(()=>t.data.房间.核心区.主浴室使用者.length>0);function m(){const e=t.data.房间.核心区.主卧室使用者;return e.length>0?e.join('、'):'-'}function f(){const e=t.data.房间.核心区.主浴室使用者;return e.length>0?e.join('、'):'-'}function g(e,r){const n='20'===e?'楼层20房间':'楼层19房间',a=t.data.房间.楼层房间[n];return a?.[r]||{入住者:[]}}function b(e,t){return g(e,t).入住者.length>0}function v(e,t){return g(e,t).入住者.length>0?'已入住':'空置'}function h(e,t){const r=g(e,t);return 0===r.入住者.length?'-':'2001'===t?'{{user}} (你)':'1901'===t?'爱宫铃 & 爱宫心爱':r.入住者.join('、')}return(e,g)=>((0,n.openBlock)(),(0,n.createElementBlock)('section',Yt,[g[24]||(g[24]=(0,n.createElementVNode)('h2',{class:'section-title'},'🏰 庇护所信息 🏰',-1)),(0,n.createElementVNode)('div',qt,[(0,n.createElementVNode)('div',Zt,[g[2]||(g[2]=(0,n.createElementVNode)('div',{class:'label'},'⚜️ 庇护所等级',-1)),(0,n.createElementVNode)('div',Qt,(0,n.toDisplayString)((0,n.unref)(t).data.庇护所.庇护所等级),1)]),(0,n.createElementVNode)('div',er,[g[3]||(g[3]=(0,n.createElementVNode)('div',{class:'label'},'🎲 今日投掷点数',-1)),(0,n.createElementVNode)('div',tr,(0,n.toDisplayString)((0,n.unref)(t).data.庇护所.今日投掷点数),1)]),(0,n.createElementVNode)('div',rr,[g[4]||(g[4]=(0,n.createElementVNode)('div',{class:'label'},'⏳ 距离下次保底升级',-1)),(0,n.createElementVNode)('div',nr,(0,n.toDisplayString)((0,n.unref)(t).data.庇护所.距离上次升级),1)]),(0,n.createElementVNode)('div',ar,[g[8]||(g[8]=(0,n.createElementVNode)('div',{class:'label'},'🔒 可扩展区域状态',-1)),(0,n.createElementVNode)('div',sr,[(0,n.createElementVNode)('div',{class:(0,n.normalizeClass)(['expansion-card',{unlocked:'未解锁'!==(0,n.unref)(t).data.庇护所.可扩展区域.医疗翼}])},[g[5]||(g[5]=(0,n.createElementVNode)('div',{class:'name'},'⚕️ 医疗翼',-1)),(0,n.createElementVNode)('div',lr,(0,n.toDisplayString)((0,n.unref)(t).data.庇护所.可扩展区域.医疗翼),1)],2),(0,n.createElementVNode)('div',{class:(0,n.normalizeClass)(['expansion-card',{unlocked:'未解锁'!==(0,n.unref)(t).data.庇护所.可扩展区域.制造工坊}])},[g[6]||(g[6]=(0,n.createElementVNode)('div',{class:'name'},'🔧 制造工坊',-1)),(0,n.createElementVNode)('div',ir,(0,n.toDisplayString)((0,n.unref)(t).data.庇护所.可扩展区域.制造工坊),1)],2),(0,n.createElementVNode)('div',{class:(0,n.normalizeClass)(['expansion-card',{unlocked:'未解锁'!==(0,n.unref)(t).data.庇护所.可扩展区域.载具格纳库}])},[g[7]||(g[7]=(0,n.createElementVNode)('div',{class:'name'},'🚜 载具格纳库',-1)),(0,n.createElementVNode)('div',or,(0,n.toDisplayString)((0,n.unref)(t).data.庇护所.可扩展区域.载具格纳库),1)],2)])]),(0,n.createCommentVNode)(' 伊甸空间地图 '),(0,n.createElementVNode)('div',cr,[g[22]||(g[22]=(0,n.createElementVNode)('div',{class:'label'},'🗺️ 伊甸空间地图',-1)),(0,n.createElementVNode)('button',{class:'map-toggle-btn',onClick:g[0]||(g[0]=e=>r.value=!r.value)},[(0,n.createElementVNode)('span',ur,(0,n.toDisplayString)(r.value?'▼':'▶'),1),(0,n.createElementVNode)('span',dr,(0,n.toDisplayString)(r.value?'收起地图':'展开地图'),1)]),(0,n.withDirectives)((0,n.createElementVNode)('div',pr,[(0,n.createCommentVNode)(' 玄关区域 '),(0,n.createElementVNode)('div',mr,[g[13]||(g[13]=(0,n.createElementVNode)('div',{class:'zone-label'},'🚪 玄关 - 净化区',-1)),(0,n.createElementVNode)('div',fr,[(0,n.createElementVNode)('div',gr,[g[9]||(g[9]=(0,n.createElementVNode)('div',{class:'room-number'},'玄关',-1)),(0,n.createElementVNode)('div',br,(0,n.toDisplayString)('就绪'),1),g[10]||(g[10]=(0,n.createElementVNode)('div',{class:'room-resident'},'净化/隔离区',-1))]),(0,n.createElementVNode)('div',{class:(0,n.normalizeClass)(['room-cell',{occupied:o.value}])},[g[11]||(g[11]=(0,n.createElementVNode)('div',{class:'room-number'},'临时客房 A',-1)),(0,n.createElementVNode)('div',vr,(0,n.toDisplayString)(o.value?'已入住':'空置'),1),(0,n.createElementVNode)('div',zr,(0,n.toDisplayString)(u('A')),1)],2),(0,n.createElementVNode)('div',{class:(0,n.normalizeClass)(['room-cell',{occupied:c.value}])},[g[12]||(g[12]=(0,n.createElementVNode)('div',{class:'room-number'},'临时客房 B',-1)),(0,n.createElementVNode)('div',hr,(0,n.toDisplayString)(c.value?'已入住':'空置'),1),(0,n.createElementVNode)('div',yr,(0,n.toDisplayString)(u('B')),1)],2)])]),(0,n.createCommentVNode)(' 核心区 '),(0,n.createElementVNode)('div',Er,[g[17]||(g[17]=(0,n.createElementVNode)('div',{class:'zone-label'},'💎 核心生活区',-1)),(0,n.createElementVNode)('div',Nr,[g[16]||(g[16]=(0,n.createStaticVNode)('<div class="room-cell highlight"><div class="room-number">客厅</div><div class="room-value">公共区域</div><div class="room-resident">-</div></div><div class="room-cell highlight"><div class="room-number">餐厅/厨房</div><div class="room-value">万象合成终端</div><div class="room-resident">-</div></div>',2)),(0,n.createElementVNode)('div',{class:(0,n.normalizeClass)(['room-cell',{occupied:d.value}])},[g[14]||(g[14]=(0,n.createElementVNode)('div',{class:'room-number'},'主卧室',-1)),(0,n.createElementVNode)('div',Vr,(0,n.toDisplayString)(d.value?'使用中':'空闲'),1),(0,n.createElementVNode)('div',kr,(0,n.toDisplayString)(m()),1)],2),(0,n.createElementVNode)('div',{class:(0,n.normalizeClass)(['room-cell',{occupied:p.value}])},[g[15]||(g[15]=(0,n.createElementVNode)('div',{class:'room-number'},'主浴室',-1)),(0,n.createElementVNode)('div',Sr,(0,n.toDisplayString)(p.value?'使用中':'空闲'),1),(0,n.createElementVNode)('div',wr,(0,n.toDisplayString)(f()),1)],2)])]),(0,n.createCommentVNode)(' 20层走廊 '),(0,n.createElementVNode)('div',Br,[g[18]||(g[18]=(0,n.createElementVNode)('div',{class:'zone-label'},'🏢 20层 - 公寓走廊',-1)),g[19]||(g[19]=(0,n.createElementVNode)('div',{class:'floor-indicator'},'↓ 通往外部楼梯',-1)),(0,n.createElementVNode)('div',_r,[((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(l,e=>(0,n.createElementVNode)('div',{key:e.number,class:(0,n.normalizeClass)(['room-cell',{'user-room':'2001'===e.number,occupied:b('20',e.number)}])},[(0,n.createElementVNode)('div',xr,(0,n.toDisplayString)(e.number),1),(0,n.createElementVNode)('div',Dr,(0,n.toDisplayString)(v('20',e.number)),1),(0,n.createElementVNode)('div',Cr,(0,n.toDisplayString)(h('20',e.number)),1)],2)),64))])]),(0,n.createCommentVNode)(' 19层走廊 '),(0,n.createElementVNode)('div',jr,[g[20]||(g[20]=(0,n.createElementVNode)('div',{class:'zone-label'},'🏢 19层 - 公寓走廊',-1)),(0,n.createElementVNode)('div',Ir,[((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(i,e=>(0,n.createElementVNode)('div',{key:e.number,class:(0,n.normalizeClass)(['room-cell',{occupied:b('19',e.number)}])},[(0,n.createElementVNode)('div',Ar,(0,n.toDisplayString)(e.number),1),(0,n.createElementVNode)('div',Or,(0,n.toDisplayString)(v('19',e.number)),1),(0,n.createElementVNode)('div',Mr,(0,n.toDisplayString)(h('19',e.number)),1)],2)),64))]),g[21]||(g[21]=(0,n.createElementVNode)('div',{class:'floor-indicator'},'↓ 通往18层',-1))])],512),[[n.vShow,r.value]])]),(0,n.createCommentVNode)(' 庇护所能力列表（可折叠） '),(0,n.createElementVNode)('div',$r,[(0,n.createElementVNode)('button',{class:'collapse-toggle-btn',onClick:g[1]||(g[1]=e=>a.value=!a.value)},[(0,n.createElementVNode)('span',Lr,(0,n.toDisplayString)(a.value?'▼':'▶'),1),g[23]||(g[23]=(0,n.createElementVNode)('span',{class:'toggle-text'},'💡 庇护所能力列表',-1))]),(0,n.withDirectives)((0,n.createElementVNode)('div',Tr,[s.value.length>0?((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,{key:0},(0,n.renderList)(s.value,(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)('div',{key:t,class:'ability-card'},[(0,n.createElementVNode)('div',Rr,(0,n.toDisplayString)(e.name),1),(0,n.createElementVNode)('div',Pr,(0,n.toDisplayString)(e.desc),1)]))),128)):((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:1},[(0,n.createTextVNode)('(暂无能力)')],64))],512),[[n.vShow,a.value]])])])]))}}),Xr={class:'section'},Fr={class:'content-text'},Wr=['src','alt'],Hr={key:1,class:'markdown-table'},Jr=['innerHTML'],Gr={key:2,class:'system-message'},Kr={key:3,class:'image-prompt'},Yr=(0,n.defineComponent)({__name:'StorySection',props:{content:{}},setup(e){const t=e,r=(0,n.computed)(()=>{const e=t.content??'',r=[...[...e.matchAll(/<content[^>]*>([\s\S]*?)<\/content>/gi)],...[...e.matchAll(/<game[^>]*>([\s\S]*?)<\/game>/gi)]].sort((e,t)=>(e.index??0)-(t.index??0)),n=r.length?r.map(e=>e[1]??'').join('\n'):e,a=r.map(e=>({start:e.index??0,end:(e.index??0)+(e[0]?.length??0)})),s=[];for(const t of e.matchAll(/image###([\s\S]*?)###/g)){const e=t.index??-1;a.some(t=>e>=t.start&&e<t.end)||s.push(t[0])}const o=n.replace(/\r\n/g,'\n').replace(/<imgthink>[\s\S]*?<\/imgthink>/gi,'').replace(/<\/?image(?:\s[^>]*)?>/gi,'').replace(/\n{3,}/g,'\n\n');if(!o.trim()&&0===s.length)return[{key:'empty',text:'(暂无正文)'}];const c=function(e){const t=/\*{0,2}>>>([\s\S]*?)<<<\*{0,2}/g,r=/image###([\s\S]*?)###/g,n=/!\[(.*?)\]\((.*?)\)/g,a=/^(?:伊甸|系统|System)[：:].*$/gm,s=[];let o=0,c=0;const u=e=>{const t=function(e){const t=e.replace(/[ \t]+\n/g,'\n').replace(/\n{3,}/g,'\n\n');return t.trim()?t:''}(e);if(t)for(const e of function(e,t){if(!e)return[];const r=/【[^】\n]+】|“[^”\n]+”|‘[^’\n]+’|"[^"\n]+"|'[^'\n]+'/g,n=[];let a=0;for(const s of e.matchAll(r)){const r=s.index??0,l=s[0]??'';r>a&&n.push({key:t(),text:e.slice(a,r)});const i=l.startsWith('【');n.push({key:t(),text:l,className:i?'inline-bracket':'dialog-text'}),a=r+l.length}a<e.length&&n.push({key:t(),text:e.slice(a)});return n}(t,()=>'t'+c++))s.push(e)};for(;o<e.length;){const d=i(e,o),p=l(t,e,o),m=l(r,e,o),f=l(n,e,o),g=l(a,e,o),b=[];if(d&&b.push({kind:'table',start:d.start,end:d.end,table:d}),p&&b.push({kind:'systemBlock',start:p.index??0,end:(p.index??0)+p[0].length,content:p[1]??''}),m&&b.push({kind:'imagePrompt',start:m.index??0,end:(m.index??0)+m[0].length,raw:m[0]}),f&&b.push({kind:'mdImage',start:f.index??0,end:(f.index??0)+f[0].length,alt:f[1]??'',url:f[2]??''}),g&&b.push({kind:'systemLine',start:g.index??0,end:(g.index??0)+g[0].length,content:g[0]??''}),0===b.length){u(e.slice(o));break}const v={table:1,systemBlock:2,imagePrompt:3,mdImage:4,systemLine:5};b.sort((e,t)=>e.start!==t.start?e.start-t.start:v[e.kind]-v[t.kind]);const h=b[0];h.start>o&&u(e.slice(o,h.start)),'table'===h.kind?s.push({key:'table'+c++,isTable:!0,tableHeaders:h.table.headers,tableRows:h.table.rows}):'systemBlock'===h.kind?s.push({key:'system'+c++,isSystem:!0,className:'system-message',text:h.content.trim()}):'imagePrompt'===h.kind?s.push({key:'imgprompt'+c++,className:'image-prompt',text:h.raw}):'mdImage'===h.kind?s.push({key:'img'+c++,isImage:!0,imageUrl:h.url,altText:h.alt,text:h.url}):'systemLine'===h.kind&&s.push({key:'system'+c++,isSystem:!0,className:'system-message',text:h.content.trim()}),o=Math.max(o,h.end)}return s.length?s:[{key:'empty',text:'(暂无正文)'}]}(o);return s.forEach((e,t)=>{c.push({key:`imgprompt_extra${c.length+t}`,className:'image-prompt',text:e})}),c.length?c:[{key:'empty',text:'(暂无正文)'}]});let a=!1;function s(){a||(a=!0,requestAnimationFrame(()=>{a=!1,window.dispatchEvent(new Event('resize'))}))}function l(e,t,r){return e.lastIndex=r,e.exec(t)}function i(e,t){let r=e.lastIndexOf('\n',Math.max(0,t-1))+1;if(r<t){const n=e.indexOf('\n',t);if(-1===n)return null;r=n+1}for(;r<e.length;){const t=e.indexOf('\n',r),n=-1===t?e.length:t,a=e.slice(r,n).trim();if(a.startsWith('|')){const t=a,s=n+1;if(s>=e.length)return null;const l=e.indexOf('\n',s),i=-1===l?e.length:l;if(o(e.slice(s,i).trim())){const n=c(t),a=[];let s=i+1,l=i;for(;s<e.length;){const t=e.indexOf('\n',s),r=-1===t?e.length:t,i=e.slice(s,r).trim();if(!i.startsWith('|'))break;const o=c(i);a.push(u(o,n.length)),l=r,s=r+1}if(n.length>=2)return{start:r,end:l,headers:n,rows:a.length?a:[u([],n.length)]}}}r=n+1}return null}function o(e){return/^\s*\|?\s*:?-{3,}:?\s*(\|\s*:?-{3,}:?\s*)+\|?\s*$/.test(e)}function c(e){let t=e.trim();t.startsWith('|')&&(t=t.slice(1)),t.endsWith('|')&&(t=t.slice(0,-1));const r=[];let n='',a=!1;for(let e=0;e<t.length;e++){const s=t[e];a?(n+=s,a=!1):'\\'!==s?'|'!==s?n+=s:(r.push(n.trim()),n=''):a=!0}return r.push(n.trim()),r}function u(e,t){const r=e.slice(0,t);for(;r.length<t;)r.push('');return r}function d(e){return e.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/&lt;span class="inline-bracket"&gt;([\s\S]*?)&lt;\/span&gt;/g,'<span class="inline-bracket">$1</span>').replace(/inline-bracket[`'"]?\s*&gt;\s*\[([^\]]+)\]/g,'<span class="inline-bracket">【$1】</span>').replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>').replace(/\*(.*?)\*/g,'<em>$1</em>').replace(/【([^】\n]+)】/g,'<span class="inline-bracket">【$1】</span>').replace(/“([^”\n]+)”/g,'<span class="dialog-text">“$1”</span>').replace(/‘([^’\n]+)’/g,'<span class="dialog-text">‘$1’</span>').replace(/"([^"\n]+)"/g,'<span class="dialog-text">"$1"</span>').replace(/'([^'\n]+)'/g,'<span class="dialog-text">\'$1\'</span>')}return(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)('section',Xr,[t[0]||(t[0]=(0,n.createElementVNode)('h2',{class:'section-title'},'📖 正文剧情 📖',-1)),(0,n.createElementVNode)('div',Fr,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(r),e=>((0,n.openBlock)(),(0,n.createElementBlock)(n.Fragment,{key:e.key},[e.isImage?((0,n.openBlock)(),(0,n.createElementBlock)('img',{key:0,src:e.imageUrl,alt:e.altText,class:'story-image',onLoad:s,onError:s},null,40,Wr)):e.isTable?((0,n.openBlock)(),(0,n.createElementBlock)('table',Hr,[(0,n.createElementVNode)('thead',null,[(0,n.createElementVNode)('tr',null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.tableHeaders,(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)('th',{key:t},(0,n.toDisplayString)(e),1))),128))])]),(0,n.createElementVNode)('tbody',null,[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e.tableRows,(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)('tr',{key:t},[(0,n.createCommentVNode)(' eslint-disable-next-line vue/no-v-html '),((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)(e,(e,t)=>((0,n.openBlock)(),(0,n.createElementBlock)('td',{key:t,innerHTML:d(e)},null,8,Jr))),128))]))),128))])])):e.isSystem?((0,n.openBlock)(),(0,n.createElementBlock)('div',Gr,[(0,n.createElementVNode)('pre',null,(0,n.toDisplayString)(e.text),1)])):'image-prompt'===e.className?((0,n.openBlock)(),(0,n.createElementBlock)('pre',Kr,(0,n.toDisplayString)(e.text),1)):((0,n.openBlock)(),(0,n.createElementBlock)('span',{key:4,class:(0,n.normalizeClass)(e.className)},(0,n.toDisplayString)(e.text),3))],64))),128))])]))}}),qr=(0,ye.A)(Yr,[['__scopeId','data-v-f10a00a4']]),Zr={class:'section'},Qr={class:'global-info-bar'},en={class:'info-item info-item--location'},tn={class:'info-item info-item--date'},rn={class:'info-item info-item--time'},nn=(0,n.defineComponent)({__name:'WorldSection',setup(e){const t=L();return(e,r)=>((0,n.openBlock)(),(0,n.createElementBlock)('section',Zr,[r[0]||(r[0]=(0,n.createElementVNode)('h2',{class:'section-title'},'🌐 基础信息 🌐',-1)),(0,n.createElementVNode)('div',Qr,[(0,n.createElementVNode)('div',en,'🗺️ '+(0,n.toDisplayString)((0,n.unref)(t).data.世界.地址),1),(0,n.createElementVNode)('div',tn,' 📅 '+(0,n.toDisplayString)((0,n.unref)(t).data.世界.日期)+'（末日第 '+(0,n.toDisplayString)((0,n.unref)(t).data.世界.末日天数)+' 天） ',1),(0,n.createElementVNode)('div',rn,'⏳ '+(0,n.toDisplayString)((0,n.unref)(t).data.世界.时间),1)])]))}}),an=new Set,sn=new Set,ln=['imgthink','drawprompt','imageprompt','genimage'];function on(e,t){return new RegExp('<'+t+'(?:\\s[^>]*)?>','i').test(e)}function cn(e){const t=function(e){let t=e;for(const e of ln)t=t.replace(new RegExp('<'+e+'(?:\\s[^>]*)?>[\\s\\S]*?<\\/'+e+'>','gi'),'');return t}(e),r=t.match(/(<(?:content|game)(?:\s[^>]*)?>(?![\s\S]*?<(?:content|game)(?:\s[^>]*)?>)[\s\S]*?(?:<\/(?:content|game)>|<\/option>|$))/i),n=r?[{start:r.index??0,end:(r.index??0)+(r[0]?.length??0)}]:[],a=t.match(/(<option(?:\s[^>]*)?>(?![\s\S]*?<option(?:\s[^>]*)?>)[\s\S]*?(?:<\/option>|$))/i),s=r?r[1].replace(/^<(?:content|game)(?:\s[^>]*)?>/i,'').replace(/<\/(?:content|game)>\s*$/i,'').replace(/<\/option>\s*$/i,'').trim():'',l=a?a[1].replace(/^<option(?:\s[^>]*)?>/i,'').replace(/<\/option>\s*$/i,'').trim():'',i=l?l.split(/\r?\n/).map(e=>e.trim()).filter(Boolean):[],o=new Set([...s.matchAll(/image###([\s\S]*?)###/g)].map(e=>e[0])),c=[];for(const e of t.matchAll(/image###([\s\S]*?)###/g)){const t=e.index??-1;if(!n.some(e=>t>=e.start&&t<e.end)){const t=e[0];o.has(t)||c.includes(t)||c.push(t)}}return{content:[s,c.join('\n')].filter(Boolean).join('\n\n').replace(/image###([\s\S]*?)###/g,(()=>{const e=new Set;return t=>e.has(t)?'':(e.add(t),t)})()).replace(/<image[^>]*>([\s\S]*?)<\/image>/gi,(()=>{const e=new Set;return(t,r)=>{const n=r.trim();return e.has(n)?'':(e.add(n),t)}})()),options:i}}function un(){const e=(0,n.ref)(''),t=(0,n.ref)([]),r=new URLSearchParams(window.location.search),a=r.has('dev'),s=a||r.has('debug'),l=()=>{if(a){const r={content:'\n\n<p><p>\n  <strong>【当前剧情】</strong>\n  你和幸存者们正在探索一栋废弃医院的二楼，寻找可用的医疗物资。空气中弥漫着消毒水和腐朽混合的怪异气味，寂静得令人不安。\n</p>\n<p>\n  <em>"小心点，这里可能还有"那些东西"。"</em> 浅见亚美紧握着手中的消防斧，低声提醒道。\n</p>\n  突然，一声刺耳的尖叫从走廊尽头传来，打破了沉寂。\n</p>\n',options:['前往尖叫声传来的方向查看','立刻寻找房间躲避','呼叫其他幸存者支援']};return e.value=r.content,void(t.value=r.options)}const r=function(e){try{const t=getCurrentMessageId(),r=getChatMessages(t)[0],n=r?.message??r?.data?.extra_text??r?.text??'';if(!n.trim())return null;const a=cn(n),s=on(n,'content')||on(n,'game'),l=on(n,'option');return e&&!an.has(t)&&(an.add(t),console.debug('[状态栏][InjectedData] 当前楼层解析',{messageId:t,rawLen:n.length,rawHasContent:s,rawHasOption:l,contentLen:a.content.length,optionsCount:a.options.length,optionsPreview:a.options.slice(0,3)})),s||!l||sn.has(t)||(sn.add(t),console.warn('[状态栏][InjectedData] 未检测到 <content>/<game>，仅检测到 <option>；因此正文会显示为空。',{messageId:t,optionsCount:a.options.length})),a.content||0!==a.options.length?a:null}catch(e){return console.error('[InjectedData] 错误:',e),null}}(s);if(r)return e.value=r.content,void(t.value=r.options)};return(0,n.onMounted)(()=>{l()}),{content:e,options:t,refresh:l}}const dn={id:'eden-main-container'},pn=(0,n.defineComponent)({__name:'App',setup(e){const{content:t,options:r}=un();return function(e,t,r={}){const{debounce:n=0,maxWait:a,...s}=r;Me(e,t,{...s,eventFilter:De(n,{maxWait:a})})}(()=>[t.value,r.value.join('\n')],()=>{window.dispatchEvent(new Event('resize'))},{debounce:200}),(e,a)=>((0,n.openBlock)(),(0,n.createElementBlock)('main',dn,[(0,n.createVNode)(nn),(0,n.createVNode)(qr,{content:(0,n.unref)(t)},null,8,['content']),(0,n.createVNode)(Ur),(0,n.createVNode)(Xt),(0,n.createVNode)(Ee),(0,n.createVNode)(Kt),(0,n.createVNode)(st,{options:(0,n.unref)(r)},null,8,['options'])]))}});$(async()=>{await async function(e=15e3){const t=Date.now(),r=()=>'function'==typeof getCurrentMessageId&&'function'==typeof getChatMessages&&'undefined'!=typeof Mvu&&'function'==typeof eventOn;if(!r()){for(;Date.now()-t<e;)if(await new Promise(e=>setTimeout(e,100)),r())return;console.warn('[状态栏] 等待依赖注入超时，部分功能可能不可用')}}(),'function'==typeof waitGlobalInitialized&&await waitGlobalInitialized('Mvu');const e=(0,n.createApp)(pn);e.use(function(){const e=(0,n.effectScope)(!0),t=e.run(()=>(0,n.ref)({}));let r=[],a=[];const s=(0,n.markRaw)({install(e){u(s),s._a=e,e.provide(d,s),e.config.globalProperties.$pinia=s,a.forEach(e=>r.push(e)),a=[]},use(e){return this._a?r.push(e):a.push(e),this},_p:r,_a:null,_e:e,_s:new Map,state:t});return s}()),e.mount('#app')}),$(window).on('pagehide',()=>{eventClearAll()})})();
//# sourceMappingURL=index.js.map</script></body></html>