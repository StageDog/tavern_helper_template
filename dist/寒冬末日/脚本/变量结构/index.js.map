{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/寒冬末日/schema.ts","src://tavern_helper_template/src/寒冬末日/脚本/变量结构/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { z } from 'zod';\n\n// ---------------------\n// 1. 通用定义\n// ---------------------\n\n// 角色通用 Schema\nconst CharacterSchema = z\n  .object({\n    姓名: z.string().prefault(''),\n\n    // 关系系统\n    关系: z\n      .enum(['拒绝', '交易', '顺从', '忠诚', '性奴'])\n      .prefault('拒绝')\n      .describe('角色当前对{{user}}的关系档位'),\n    关系倾向: z\n      .enum(['拒绝', '交易', '顺从', '忠诚', '性奴'])\n      .prefault('拒绝')\n      .describe('角色关系的倾向（可理解为更偏向于哪一档）'),\n    秩序刻印: z\n      .coerce.number()\n      .min(0)\n      .max(100)\n      .prefault(20)\n      .describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),\n    秩序刻印更新原因: z\n      .string()\n      .prefault('')\n      .describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),\n\n    // 健康系统\n    健康: z.coerce\n      .number()\n      .min(0)\n      .max(100)\n      .prefault(100)\n      .describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),\n    健康更新原因: z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),\n    健康状况: z\n      .enum(['健康', '亚健康', '生病/受伤', '重病/濒死', '无', '死亡'])\n      .prefault('健康')\n      .describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),\n\n    // 外貌与状态 (纯文本描述)\n    衣着: z.string().prefault('').describe('详细描述当前的衣着状态'),\n    舌唇: z.string().prefault('').describe('口腔、嘴唇的状态'),\n    胸乳: z.string().prefault('').describe('胸部的状态'),\n    私穴: z.string().prefault('').describe('私处的详细状态'),\n    神态样貌: z.string().prefault('').describe('面部表情和神态'),\n    动作姿势: z.string().prefault('').describe('身体姿态和动作'),\n\n    // 心理\n    内心想法: z.string().prefault('').describe('第一人称内心独白'),\n\n    // 系统控制\n    登场状态: z.enum(['登场', '离场']).prefault('离场').describe('值为\"登场\"时显示在UI。角色不出现时设为\"离场\"'),\n  })\n  .prefault({\n    姓名: '',\n    关系: '拒绝',\n    关系倾向: '拒绝',\n    秩序刻印: 20,\n    健康: 100,\n    健康更新原因: '',\n    健康状况: '健康',\n    衣着: '',\n    舌唇: '',\n    胸乳: '',\n    私穴: '',\n    神态样貌: '',\n    动作姿势: '',\n    内心想法: '',\n    秩序刻印更新原因: '',\n    登场状态: '离场',\n  });\n\n// 2. 世界环境\nconst WorldSchema = z\n  .object({\n    地址: z.string().prefault('').describe('当前所在的物理位置'),\n    日期: z.string().prefault('').describe('格式：末日纪元，XXXX年XX月XX日'),\n    时间: z.string().prefault('').describe('格式：时间段 - HH:MM'),\n    末日天数: z.coerce.number().prefault(0).describe('自\"永恒暴雪\"降临以来的总天数'),\n  })\n  .prefault({\n    地址: '',\n    日期: '',\n    时间: '',\n    末日天数: 0,\n  });\n\n// 3. 庇护所\nconst ShelterSchema = z\n  .object({\n    庇护所等级: z.coerce.number().max(10).prefault(1),\n    今日投掷点数: z.string().prefault('').describe('记录每日升级判定结果'),\n    距离上次升级: z.string().prefault('').describe('记录保底进度'),\n    庇护所能力: z\n      .array(\n        z.object({\n          name: z.string(),\n          desc: z.string(),\n        }),\n      )\n      .prefault([])\n      .describe('已激活的庇护所能力列表。请严格参照世界书条目<庇护所升级能力>添加新能力。'),\n    可扩展区域: z\n      .object({\n        医疗翼: z.string().prefault('未解锁').describe('等级3解锁'),\n        制造工坊: z.string().prefault('未解锁').describe('等级4解锁'),\n        载具格纳库: z.string().prefault('未解锁').describe('等级7解锁'),\n      })\n      .prefault({\n        医疗翼: '未解锁',\n        制造工坊: '未解锁',\n        载具格纳库: '未解锁',\n      })\n      .describe('记录庇护所可扩展区域的解锁状态'),\n  })\n  .prefault({\n    庇护所等级: 1,\n    今日投掷点数: '',\n    距离上次升级: '',\n    庇护所能力: [],\n    可扩展区域: {\n      医疗翼: '未解锁',\n      制造工坊: '未解锁',\n      载具格纳库: '未解锁',\n    },\n  });\n\n// 3.1 房间系统\nconst RoomSchema = z\n  .object({\n    玄关: z\n      .object({\n        临时客房A入住者: z.array(z.string()).prefault([]).describe('临时客房A入住者姓名列表'),\n        临时客房B入住者: z.array(z.string()).prefault([]).describe('临时客房B入住者姓名列表'),\n      })\n      .prefault({\n        临时客房A入住者: [],\n        临时客房B入住者: [],\n      })\n      .describe('玄关区域房间状态'),\n    核心区: z\n      .object({\n        主卧室使用者: z.array(z.string()).prefault([]).describe('主卧室使用者姓名列表'),\n        主浴室使用者: z.array(z.string()).prefault([]).describe('主浴室使用者姓名列表'),\n      })\n      .prefault({\n        主卧室使用者: [],\n        主浴室使用者: [],\n      })\n      .describe('核心区域房间状态'),\n    楼层房间: z\n      .object({\n        楼层20房间: z\n          .record(z.string(), z.object({ 入住者: z.array(z.string()) }).prefault({ 入住者: [] }))\n          .prefault({})\n          .describe('20层各房间状态，key为房间号'),\n        楼层19房间: z\n          .record(z.string(), z.object({ 入住者: z.array(z.string()) }).prefault({ 入住者: [] }))\n          .prefault({})\n          .describe('19层各房间状态，key为房间号'),\n      })\n      .prefault({\n        楼层20房间: {},\n        楼层19房间: {},\n      })\n      .describe('楼层房间状态'),\n  })\n  .prefault({\n    玄关: {\n      临时客房A入住者: [],\n      临时客房B入住者: [],\n    },\n    核心区: {\n      主卧室使用者: [],\n      主浴室使用者: [],\n    },\n    楼层房间: {\n      楼层20房间: {},\n      楼层19房间: {},\n    },\n  });\n\n// 4. 其他住户\nconst NeighborsSchema = z\n  .object({\n    言语: z.string().prefault('').describe('其他幸存者的总体言语状态'),\n    行为: z.string().prefault('').describe('其他幸存者的总体行为状态'),\n  })\n  .prefault({\n    言语: '',\n    行为: '',\n  });\n\n// 5. 主 Schema\n// ---------------------\nconst MissionSchema = z\n  .object({\n    当前阶段: z.string().prefault('阶段一：秩序的萌芽').describe('主线任务的当前阶段名称'),\n    阶段目标: z\n      .array(\n        z.object({\n          描述: z.string(),\n          当前值: z.number().prefault(0),\n          目标值: z.number().prefault(1),\n        }),\n      )\n      .prefault([\n        { 描述: '肃清20、19、21层的敌对幸存者', 当前值: 0, 目标值: 3 },\n        { 描述: '庇护至少3个核心女性角色或家庭', 当前值: 0, 目标值: 3 },\n        { 描述: '完成一个公寓内部的情报碎片任务', 当前值: 0, 目标值: 1 },\n      ])\n      .describe('当前阶段需要达成的目标列表'),\n    目标完成状态: z\n      .record(z.string(), z.boolean())\n      .prefault({\n        '0': false,\n        '1': false,\n        '2': false,\n      })\n      .describe('目标完成状态，key为索引字符串（0/1/2...），value为true表示完成'),\n    情报碎片: z\n      .record(\n        z.string(),\n        z\n          .object({\n            编号: z.string().prefault(''),\n            描述: z.string().prefault(''),\n            价值: z.string().prefault(''),\n            风险: z.string().prefault(''),\n            状态: z.enum(['未探索', '已探索', '已完成']).prefault('未探索'),\n          })\n          .prefault({\n            编号: '',\n            描述: '',\n            价值: '',\n            风险: '',\n            状态: '未探索',\n          }),\n      )\n      .prefault({})\n      .describe('已解锁的情报碎片'),\n  })\n  .prefault({\n    当前阶段: '阶段一：秩序的萌芽',\n    阶段目标: [\n      { 描述: '肃清20、19、21层的敌对幸存者', 当前值: 0, 目标值: 3 },\n      { 描述: '庇护至少3个核心女性角色或家庭', 当前值: 0, 目标值: 3 },\n      { 描述: '完成一个公寓内部的情报碎片任务', 当前值: 0, 目标值: 1 },\n    ],\n    目标完成状态: {\n      '0': false,\n      '1': false,\n      '2': false,\n    },\n    情报碎片: {},\n  });\n\nexport const Schema = z.object({\n  世界: WorldSchema,\n  庇护所: ShelterSchema,\n  房间: RoomSchema,\n  主线任务: MissionSchema,\n\n  // 主要角色\n  浅见亚美: CharacterSchema,\n  相田哲也: CharacterSchema,\n  星野琉璃: CharacterSchema,\n  早川遥: CharacterSchema,\n  早川舞: CharacterSchema,\n  藤井雪乃: CharacterSchema,\n  中村惠子: CharacterSchema,\n  爱宫心爱: CharacterSchema,\n  爱宫铃: CharacterSchema,\n  '桃乐丝・泽巴哈': CharacterSchema,\n  何铃: CharacterSchema,\n  王静: CharacterSchema,\n  康绮月: CharacterSchema,\n  薛萍: CharacterSchema,\n  小泽花: CharacterSchema,\n\n  // 动态 NPC (Record)\n  临时NPC: z\n    .record(z.string(), CharacterSchema)\n    .prefault({})\n    .describe('存储所有临时NPC的状态，key为NPC姓名。新NPC登场时在此处添加。'),\n\n  楼层其他住户: NeighborsSchema,\n});\n\nexport type Schema = z.output<typeof Schema>;\n","import { registerMvuSchema } from 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js';\nimport { Schema } from '../../schema';\n\n$(() => {\n  registerMvuSchema(Schema);\n});\n"],"names":["z","CharacterSchema","object","string","prefault","enum","describe","coerce","number","min","max","WorldSchema","ShelterSchema","array","name","desc","RoomSchema","record","NeighborsSchema","MissionSchema","boolean","Schema","$"],"ignoreList":[],"sourceRoot":""}