{"version":3,"file":"index.js","mappings":"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","sources":["src://tavern_helper_template/external var \"z\"","src://tavern_helper_template/src/寒冬末日/schema.ts","src://tavern_helper_template/src/寒冬末日/脚本/变量结构/index.ts"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = z;","import { z } from 'zod';\n\n// ---------------------\n// 1. 通用定义\n// ---------------------\n\n// 角色通用 Schema\nconst CharacterSchema = z\n  .object({\n    姓名: z.string().prefault(''),\n\n    // 关系系统\n    关系: z.enum(['拒绝', '交易', '顺从', '忠诚', '性奴']).optional(),\n    关系倾向: z.enum(['拒绝', '交易', '顺从', '忠诚', '性奴']).optional(),\n    秩序刻印: z\n      .number()\n      .min(0)\n      .max(100)\n      .prefault(20)\n      .describe('Imp数值(0-100)，衡量关系深度。0-19拒绝, 20-39交易, 40-59顺从, 60-89忠诚, 90-100性奴'),\n    秩序刻印更新原因: z\n      .string()\n      .prefault('')\n      .describe('记录秩序刻印变化的原因和数值，格式示例：+3, 高级设施体验 / -5, 期望落空'),\n\n    // 健康系统\n    健康: z.coerce\n      .number()\n      .min(0)\n      .max(100)\n      .prefault(100)\n      .describe('范围0-100。记录健康数值。获得食物/温暖增加；受伤/饥饿/寒冷减少。'),\n    健康更新原因: z.string().prefault('').describe('记录健康值变化的原因和数值，格式：+/-X, 原因描述'),\n    健康状况: z\n      .enum(['健康', '亚健康', '生病/受伤', '重病/濒死', '无', '死亡'])\n      .prefault('健康')\n      .describe('>=80:健康; 60-79:亚健康; 30-59:生病/受伤; <30:重病/濒死'),\n\n    // 外貌与状态 (纯文本描述)\n    衣着: z.string().prefault('').describe('详细描述当前的衣着状态'),\n    舌唇: z.string().prefault('').describe('口腔、嘴唇的状态'),\n    胸乳: z.string().prefault('').describe('胸部的状态'),\n    私穴: z.string().prefault('').describe('私处的详细状态'),\n    神态样貌: z.string().prefault('').describe('面部表情和神态'),\n    动作姿势: z.string().prefault('').describe('身体姿态和动作'),\n\n    // 心理\n    内心想法: z.string().prefault('').describe('第一人称内心独白'),\n\n    // 系统控制\n    登场状态: z.enum(['登场', '离场']).prefault('离场').describe('值为\"登场\"时显示在UI。角色不出现时设为\"离场\"'),\n  })\n  .prefault({\n    姓名: '',\n    健康: 100,\n    健康更新原因: '',\n    健康状况: '健康',\n    衣着: '',\n    舌唇: '',\n    胸乳: '',\n    私穴: '',\n    神态样貌: '',\n    动作姿势: '',\n    内心想法: '',\n    秩序刻印更新原因: '',\n    登场状态: '离场',\n  });\n\n// 2. 世界环境\nconst WorldSchema = z\n  .object({\n    地址: z.string().prefault('').describe('当前所在的物理位置'),\n    日期: z.string().prefault('').describe('格式：末日纪元，XXXX年XX月XX日'),\n    时间: z.string().prefault('').describe('格式：时间段 - HH:MM'),\n    末日天数: z.coerce.number().prefault(0).describe('自\"永恒暴雪\"降临以来的总天数'),\n  })\n  .prefault({\n    地址: '',\n    日期: '',\n    时间: '',\n    末日天数: 0,\n  });\n\n// 3. 庇护所\nconst ShelterSchema = z\n  .object({\n    庇护所等级: z.coerce.number().max(10).prefault(1),\n    今日投掷点数: z.string().prefault('').describe('记录每日升级判定结果'),\n    距离上次升级: z.string().prefault('').describe('记录保底进度'),\n    庇护所能力: z\n      .array(\n        z.object({\n          name: z.string(),\n          desc: z.string(),\n        }),\n      )\n      .prefault([])\n      .describe('已激活的庇护所能力列表。请严格参照世界书条目<庇护所升级能力>添加新能力。'),\n    可扩展区域: z\n      .object({\n        医疗翼: z.string().prefault('未解锁').describe('等级3解锁'),\n        制造工坊: z.string().prefault('未解锁').describe('等级4解锁'),\n        载具格纳库: z.string().prefault('未解锁').describe('等级7解锁'),\n      })\n      .prefault({\n        医疗翼: '未解锁',\n        制造工坊: '未解锁',\n        载具格纳库: '未解锁',\n      })\n      .describe('记录庇护所可扩展区域的解锁状态'),\n  })\n  .prefault({\n    庇护所等级: 1,\n    今日投掷点数: '',\n    距离上次升级: '',\n    庇护所能力: [],\n    可扩展区域: {\n      医疗翼: '未解锁',\n      制造工坊: '未解锁',\n      载具格纳库: '未解锁',\n    },\n  });\n\n// 3.1 房间系统\nconst RoomSchema = z\n  .object({\n    玄关: z\n      .object({\n        临时客房A入住者: z.array(z.string()).prefault([]).describe('临时客房A入住者姓名列表'),\n        临时客房B入住者: z.array(z.string()).prefault([]).describe('临时客房B入住者姓名列表'),\n      })\n      .prefault({\n        临时客房A入住者: [],\n        临时客房B入住者: [],\n      })\n      .describe('玄关区域房间状态'),\n    核心区: z\n      .object({\n        主卧室使用者: z.array(z.string()).prefault([]).describe('主卧室使用者姓名列表'),\n        主浴室使用者: z.array(z.string()).prefault([]).describe('主浴室使用者姓名列表'),\n      })\n      .prefault({\n        主卧室使用者: [],\n        主浴室使用者: [],\n      })\n      .describe('核心区域房间状态'),\n    楼层房间: z\n      .object({\n        楼层20房间: z\n          .record(z.string(), z.object({ 入住者: z.array(z.string()) }).prefault({ 入住者: [] }))\n          .prefault({})\n          .describe('20层各房间状态，key为房间号'),\n        楼层19房间: z\n          .record(z.string(), z.object({ 入住者: z.array(z.string()) }).prefault({ 入住者: [] }))\n          .prefault({})\n          .describe('19层各房间状态，key为房间号'),\n      })\n      .prefault({\n        楼层20房间: {},\n        楼层19房间: {},\n      })\n      .describe('楼层房间状态'),\n  })\n  .prefault({\n    玄关: {\n      临时客房A入住者: [],\n      临时客房B入住者: [],\n    },\n    核心区: {\n      主卧室使用者: [],\n      主浴室使用者: [],\n    },\n    楼层房间: {\n      楼层20房间: {},\n      楼层19房间: {},\n    },\n  });\n\n// 4. 其他住户\nconst NeighborsSchema = z\n  .object({\n    言语: z.string().prefault('').describe('其他幸存者的总体言语状态'),\n    行为: z.string().prefault('').describe('其他幸存者的总体行为状态'),\n  })\n  .prefault({\n    言语: '',\n    行为: '',\n  });\n\n// 5. 主 Schema\n// ---------------------\nconst MissionSchema = z\n  .object({\n    当前阶段: z.string().prefault('阶段一：秩序的萌芽').describe('主线任务的当前阶段名称'),\n    阶段目标: z\n      .array(\n        z.object({\n          描述: z.string(),\n          当前值: z.number().prefault(0),\n          目标值: z.number().prefault(1),\n        }),\n      )\n      .prefault([\n        { 描述: '肃清20、19、21层的敌对幸存者', 当前值: 0, 目标值: 3 },\n        { 描述: '庇护至少3个核心女性角色或家庭', 当前值: 0, 目标值: 3 },\n        { 描述: '完成一个公寓内部的情报碎片任务', 当前值: 0, 目标值: 1 },\n      ])\n      .describe('当前阶段需要达成的目标列表'),\n    目标完成状态: z\n      .record(z.string(), z.boolean())\n      .prefault({\n        '0': false,\n        '1': false,\n        '2': false,\n      })\n      .describe('目标完成状态，key为索引字符串（0/1/2...），value为true表示完成'),\n    情报碎片: z\n      .record(\n        z.string(),\n        z\n          .object({\n            编号: z.string().prefault(''),\n            描述: z.string().prefault(''),\n            价值: z.string().prefault(''),\n            风险: z.string().prefault(''),\n            状态: z.enum(['未探索', '已探索', '已完成']).prefault('未探索'),\n          })\n          .prefault({\n            编号: '',\n            描述: '',\n            价值: '',\n            风险: '',\n            状态: '未探索',\n          }),\n      )\n      .prefault({})\n      .describe('已解锁的情报碎片'),\n  })\n  .prefault({\n    当前阶段: '阶段一：秩序的萌芽',\n    阶段目标: [\n      { 描述: '肃清20、19、21层的敌对幸存者', 当前值: 0, 目标值: 3 },\n      { 描述: '庇护至少3个核心女性角色或家庭', 当前值: 0, 目标值: 3 },\n      { 描述: '完成一个公寓内部的情报碎片任务', 当前值: 0, 目标值: 1 },\n    ],\n    目标完成状态: {\n      '0': false,\n      '1': false,\n      '2': false,\n    },\n    情报碎片: {},\n  });\n\nexport const Schema = z.object({\n  世界: WorldSchema,\n  庇护所: ShelterSchema,\n  房间: RoomSchema,\n  主线任务: MissionSchema,\n\n  // 主要角色\n  浅见亚美: CharacterSchema,\n  相田哲也: CharacterSchema,\n  星野琉璃: CharacterSchema,\n  早川遥: CharacterSchema,\n  早川舞: CharacterSchema,\n  藤井雪乃: CharacterSchema,\n  中村惠子: CharacterSchema,\n  爱宫心爱: CharacterSchema,\n  爱宫铃: CharacterSchema,\n  '桃乐丝・泽巴哈': CharacterSchema,\n  何铃: CharacterSchema,\n  王静: CharacterSchema,\n  康绮月: CharacterSchema,\n  薛萍: CharacterSchema,\n  小泽花: CharacterSchema,\n\n  // 动态 NPC (Record)\n  临时NPC: z\n    .record(z.string(), CharacterSchema)\n    .prefault({})\n    .describe('存储所有临时NPC的状态，key为NPC姓名。新NPC登场时在此处添加。'),\n\n  楼层其他住户: NeighborsSchema,\n});\n\nexport type Schema = z.output<typeof Schema>;\n","import { registerMvuSchema } from 'https://testingcf.jsdelivr.net/gh/StageDog/tavern_resource/dist/util/mvu_zod.js';\nimport { Schema } from '../../schema';\n\n$(() => {\n  registerMvuSchema(Schema);\n});\n"],"names":["z","CharacterSchema","object","string","prefault","enum","optional","number","min","max","describe","coerce","WorldSchema","ShelterSchema","array","name","desc","RoomSchema","record","NeighborsSchema","MissionSchema","boolean","Schema","$"],"ignoreList":[],"sourceRoot":""}