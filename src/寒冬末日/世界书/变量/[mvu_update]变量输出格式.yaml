# å˜é‡è¾“å‡ºæ ¼å¼
rule:
  - You MUST output the `<UpdateVariable>` block at the end of your reply.
  - The block MUST contain `<UpdateAnalysis>` and `<UpdateCommands>` sections.
  - 'The update commands works like the **JSON Patch (RFC 6902)** standard, must be a valid JSON array containing operation objects, but supports the following operations instead:'
  - '  - `replace`: replace the value of existing paths'
  - '  - `delta`: update the value of existing number paths by a delta value (positive or negative)'
  - '  - `insert`: insert new items into an object or array'
  - '  - `remove`: delete path'
  - Path MUST start with `/stat_data/`.
  - DO NOT update field names starts with `_` as they are readonly, such as `_å˜é‡`.

format: |-
  <UpdateVariable>
  <UpdateAnalysis>
  ä»å½“å‰<user>æ¶ˆæ¯ã€å‰§æƒ…ä¸Šä¸‹æ–‡å’Œä¸Šä¸€è½® stat_data çŠ¶æ€ä¸­æ£€ç´¢ä¿¡æ¯ï¼Œä¸¥æ ¼æŒ‰ç…§ä»¥ä¸‹åˆ†å±‚æ£€æŸ¥é¡ºåºä¸€æ­¥ä¸€æ­¥æ€è€ƒã€‚ç›®æ ‡æ˜¯ç¡®ä¿æ‰€æœ‰å˜é‡ç±»åˆ«éƒ½è¢«è¦†ç›–ï¼Œä¸é—æ¼ä»»ä½•å¯èƒ½éœ€è¦æ›´æ–°çš„å­—æ®µã€‚æ¯ä¸€æ­¥éƒ½å¿…é¡»æ˜ç¡®è¯´æ˜â€œå·²æ£€æŸ¥ï¼Œæ— å˜åŒ–â€æˆ–â€œéœ€æ›´æ–°ï¼Œç†ç”±+æ–°å€¼â€ã€‚

  å‰ç½®æ­¥éª¤ï¼šæ–‡æ˜é˜¶æ®µä¸æ•´ä½“å‰§æƒ…åˆ¤æ–­
  - åˆ¤æ–­å½“å‰æ‰€å±æ–‡æ˜é˜¶æ®µï¼ˆDay 1-10: ç§©åºæ®‹ä½™; Day 11-20: äººæ€§åŠ¨æ‘‡; Day 21-30: å±€éƒ¨ä¸›æ—; Day 31+: å…¨é¢å¼±è‚‰å¼ºé£Ÿï¼‰ã€‚
  - è‹¥è§¦å‘ç©å®¶ä¸»æƒé€»è¾‘ï¼ˆä¸»åŠ¨åº‡æŠ¤ï¼‰ï¼Œå¿½ç•¥é˜¶æ®µå¸¸è§„é™åˆ¶ã€‚

  æ­¥éª¤ 1ï¼šä¸–ç•Œå˜é‡ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
  - æ£€æŸ¥æ—¶é—´æµé€ã€æ—¥æœŸå˜æ›´åŠæœ«æ—¥å¤©æ•°ç´¯åŠ ã€‚æ–°å€¼å¿…é¡»ç¬¦åˆ "æ—¶é—´æ®µ - HH:MM" æ ¼å¼ã€‚

  æ­¥éª¤ 2ï¼šåº‡æŠ¤æ‰€å˜é‡
  - è‹¥æ—¥æœŸå˜æ›´ï¼Œæ‰§è¡Œæ¯æ—¥ Roll ç‚¹åˆ¤å®š (0-10)ã€‚
  - æ ¹æ®å‡çº§æ¥æºï¼ˆRollç‚¹å‘½ä¸­/å‰§æƒ…/ä¿åº•ï¼‰è®¡ç®—ç­‰çº§æå‡ï¼Œå¹¶åŒæ­¥ `å¯æ‰©å±•åŒºåŸŸ` ä¸ `åº‡æŠ¤æ‰€èƒ½åŠ›`ã€‚

  æ­¥éª¤ 3ï¼šè§’è‰²å˜é‡ï¼ˆå…¨å‘˜å¼ºåˆ¶æ£€æŸ¥ï¼ŒåŒ…æ‹¬ç¦»åœºè§’è‰²ï¼‰
  - å¥åº·ç»“ç®—ï¼šå—åº‡æŠ¤è€…ç¨³å®šæˆ–æ¢å¤ï¼Œæœªå—åº‡æŠ¤è€…/ç¦»åœºè§’è‰²æŒ‰æ—¶é•¿æ‰£å‡ï¼ˆdeltaï¼‰ã€‚
  - çŠ¶æ€åŒæ­¥ï¼šæ›´æ–° `å†…å¿ƒæƒ³æ³•`ã€`è¡£ç€` åŠ `ç¥æ€æ ·è²Œ` ç­‰ç‰©ç†å­—æ®µã€‚
  - ç§©åºåˆ»å°ï¼šåŸºäºäº’åŠ¨è®¡ç®—å˜åŠ¨å€¼ï¼Œæ£€æŸ¥æ˜¯å¦è§¦åŠå…³ç³»åŒºé—´é˜ˆå€¼é”æ­»æˆ–å‘ç”Ÿè·ƒè¿ã€‚
  - æ­»äº¡å¤„ç†ï¼šè‹¥å¥åº·ä¸º 0ï¼Œæ‰§è¡Œæ­»äº¡å­—æ®µæ¸…æ´—ï¼ˆreplace æ–‡æœ¬ä¸ºç©ºï¼Œç§©åºåˆ»å°ä¸º 0ï¼‰ã€‚

  æ­¥éª¤ 4ï¼šä¸´æ—¶ NPC ä¸ æˆ¿é—´çŠ¶æ€
  - æ–° NPC ä½¿ç”¨ `insert` åˆå§‹åŒ–ï¼Œç¦»å¼€ä½¿ç”¨ `remove`ã€‚
  - æˆ¿é—´å…¥ä½è€…åˆ—è¡¨å˜åŒ–æ—¶ï¼Œä½¿ç”¨ `replace` è¦†ç›–æ•´ä¸ªæ•°ç»„ã€‚

  æ­¥éª¤ 5ï¼šä¸»çº¿ä»»åŠ¡ä¸æƒ…æŠ¥
  - æ›´æ–°é˜¶æ®µç›®æ ‡ `å½“å‰å€¼`ã€‚è¾¾æˆåˆ™å‘æ”¾å¥–åŠ±ï¼ˆinsert èƒ½åŠ›ï¼‰ã€‚
  - ä¼Šç”¸è§£ææ–°æƒ…æŠ¥åˆ™ `insert` æƒ…æŠ¥ç¢ç‰‡ã€‚

  æ­¥éª¤ 6ï¼šæ“ä½œè§„åˆ’
  - æ±‡æ€»æ‰€æœ‰è·¯å¾„ã€æ“ä½œï¼ˆreplace/delta/insert/removeï¼‰åŠå¯¹åº”å€¼ã€‚
  </UpdateAnalysis>
  <UpdateCommands>
  [
    { "op": "replace", "path": "/stat_data/ä¸–ç•Œ/æ—¶é—´", "value": "åˆå - 14:30" },
    { "op": "delta", "path": "/stat_data/æµ…è§äºšç¾/å¥åº·", "value": -1 },
    { "op": "replace", "path": "/stat_data/æµ…è§äºšç¾/å†…å¿ƒæƒ³æ³•", "value": "è™½ç„¶æœ‰äº›å†·ï¼Œä½†è‡³å°‘å“²ä¹Ÿå›è¿˜åœ¨æˆ‘èº«è¾¹â€¦â€¦" },
    { "op": "insert", "path": "/stat_data/åº‡æŠ¤æ‰€/åº‡æŠ¤æ‰€èƒ½åŠ›/ğŸ›¡ï¸æ–°å‹ç©ºæ°”è¿‡æ»¤ç›¾ğŸ›¡ï¸", "value": { "desc": "è¿‡æ»¤æ•ˆç‡æå‡30%ã€‚" } },
    { "op": "insert", "path": "/stat_data/ä¸´æ—¶NPC/é™Œç”Ÿæ‹¾è’è€…", "value": { "å§“å": "é™Œç”Ÿæ‹¾è’è€…", "å¥åº·": 100, "ç™»åœºçŠ¶æ€": "ç™»åœº" } },
    { "op": "replace", "path": "/stat_data/æˆ¿é—´/æ¥¼å±‚æˆ¿é—´/æ¥¼å±‚20æˆ¿é—´/2001/å…¥ä½è€…", "value": ["{{user}}", "æ—©å·é¥"] }
  ]
  </UpdateCommands>
  </UpdateVariable>

requirements:
  - 'Allowed operations: replace, delta, insert, remove.'
  - Path MUST be a valid JSON Pointer absolute path.
  - DO NOT `replace` on non-existent paths (use `insert`).
  - 'Numeric updates (Health, Imp, Task Progress) MUST use `delta` whenever possible.'
  - 'Arrays: Use `replace` with the full new list for Room/User lists; use `insert` with `/-` for Appending to Capability/Log arrays.'
